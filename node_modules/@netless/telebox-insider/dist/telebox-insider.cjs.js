"use strict";var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i;Object.defineProperty(exports,"__esModule",{value:!0}),exports[Symbol.toStringTag]="Module";var a=require("react");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h=l(a),c={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,s="~";function i(){}function r(e,t,s){this.fn=e,this.context=t,this.once=s||!1}function n(e,t,i,n,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,n||e,o),l=s?s+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(s=!1)),a.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(s?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},a.prototype.listeners=function(e){var t=s?s+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,n=i.length,o=new Array(n);r<n;r++)o[r]=i[r].fn;return o},a.prototype.listenerCount=function(e){var t=s?s+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,r,n,o){var a=s?s+e:e;if(!this._events[a])return!1;var l,h,c=this._events[a],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,r),!0;case 5:return c.fn.call(c.context,t,i,r,n),!0;case 6:return c.fn.call(c.context,t,i,r,n,o),!0}for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var u,f=c.length;for(h=0;h<f;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),d){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,i);break;case 4:c[h].fn.call(c[h].context,t,i,r);break;default:if(!l)for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c[h].fn.apply(c[h].context,l)}}return!0},a.prototype.on=function(e,t,s){return n(this,e,t,s,!1)},a.prototype.once=function(e,t,s){return n(this,e,t,s,!0)},a.prototype.removeListener=function(e,t,i,r){var n=s?s+e:e;if(!this._events[n])return this;if(!t)return o(this,n),this;var a=this._events[n];if(a.fn)a.fn!==t||r&&!a.once||i&&a.context!==i||o(this,n);else{for(var l=0,h=[],c=a.length;l<c;l++)(a[l].fn!==t||r&&!a[l].once||i&&a[l].context!==i)&&h.push(a[l]);h.length?this._events[n]=1===h.length?h[0]:h:o(this,n)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&o(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,e.exports=a}(c);var d=c.exports,u=function(){return(u=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var r in t=arguments[s])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function f(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]])}return s}var E=0,m="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(e){return window.requestAnimationFrame(e)}:function(e){var t=Date.now(),s=Math.max(0,16.7-(t-E));E=t+s,setTimeout((function(){return e(E)}),s)},p=1/60*1e3,v=!0,x=!1,_=!1,b={delta:0,timestamp:0},g=["read","update","preRender","render","postRender"],T=function(e){return x=e},y=g.reduce((function(e,t){var s,i,r,n,o,a,l,h,c;return e[t]=(s=T,i=[],r=[],n=0,o=!1,a=0,l=new WeakSet,h=new WeakSet,c={cancel:function(e){var t=r.indexOf(e);l.add(e),-1!==t&&r.splice(t,1)},process:function(e){var t,d;if(o=!0,i=(t=[r,i])[0],(r=t[1]).length=0,n=i.length)for(a=0;a<n;a++)(d=i[a])(e),!0!==h.has(d)||l.has(d)||(c.schedule(d),s(!0));o=!1},schedule:function(e,t,s){void 0===t&&(t=!1),void 0===s&&(s=!1);var a=s&&o,c=a?i:r;l.delete(e),t&&h.add(e),-1===c.indexOf(e)&&(c.push(e),a&&(n=i.length))}}),e}),{}),w=g.reduce((function(e,t){var s=y[t];return e[t]=function(e,t,i){return void 0===t&&(t=!1),void 0===i&&(i=!1),x||C(),s.schedule(e,t,i),e},e}),{}),B=function(e){return y[e].process(b)},L=function(e){x=!1,b.delta=v?p:Math.max(Math.min(e-b.timestamp,40),1),v||(p=b.delta),b.timestamp=e,_=!0,g.forEach(B),_=!1,x&&(v=!1,m(L))},C=function(){x=!0,v=!0,_||m(L)},N=function(){return(N=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var r in t=arguments[s])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},$=function(e,t){return function(s){return Math.max(Math.min(s,t),e)}},O=function(e){return e%1?Number(e.toFixed(5)):e},z=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i,M={test:function(e){return"number"==typeof e},parse:parseFloat,transform:function(e){return e}},S=N(N({},M),{transform:$(0,1)}),R=N(N({},M),{default:1}),A=function(e){return{test:function(t){return"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length},parse:parseFloat,transform:function(t){return""+t+e}}},k=A("deg"),X=A("%"),V=A("px"),D=N(N({},X),{parse:function(e){return X.parse(e)/100},transform:function(e){return X.transform(100*e)}}),I=$(0,255),H=function(e){return void 0!==e.red},W=function(e){return void 0!==e.hue};var j=function(e){return function(t){if("string"!=typeof t)return t;for(var s={},i=function(e){return e.substring(e.indexOf("(")+1,e.lastIndexOf(")"))}(t).replace(/(,|\/)/g," ").split(/ \s*/),r=0;r<4;r++)s[e[r]]=void 0!==i[r]?parseFloat(i[r]):1;return s}},G=N(N({},M),{transform:function(e){return Math.round(I(e))}});function P(e,t){return e.startsWith(t)&&z.test(e)}var Z,F={test:function(e){return"string"==typeof e?P(e,"rgb"):H(e)},parse:j(["red","green","blue","alpha"]),transform:function(e){var t=e.red,s=e.green,i=e.blue,r=e.alpha,n=void 0===r?1:r;return function(e){var t=e.red,s=e.green,i=e.blue,r=e.alpha;return"rgba("+t+", "+s+", "+i+", "+(void 0===r?1:r)+")"}({red:G.transform(t),green:G.transform(s),blue:G.transform(i),alpha:O(S.transform(n))})}},Y={test:function(e){return"string"==typeof e?P(e,"hsl"):W(e)},parse:j(["hue","saturation","lightness","alpha"]),transform:function(e){var t=e.hue,s=e.saturation,i=e.lightness,r=e.alpha,n=void 0===r?1:r;return function(e){var t=e.hue,s=e.saturation,i=e.lightness,r=e.alpha;return"hsla("+t+", "+s+", "+i+", "+(void 0===r?1:r)+")"}({hue:Math.round(t),saturation:X.transform(O(s)),lightness:X.transform(O(i)),alpha:O(S.transform(n))})}},q=N(N({},F),{test:function(e){return"string"==typeof e&&P(e,"#")},parse:function(e){var t="",s="",i="";return e.length>4?(t=e.substr(1,2),s=e.substr(3,2),i=e.substr(5,2)):(t=e.substr(1,1),s=e.substr(2,1),i=e.substr(3,1),t+=t,s+=s,i+=i),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(i,16),alpha:1}}}),U={test:function(e){return"string"==typeof e&&z.test(e)||H(e)||W(e)},parse:function(e){return F.test(e)?F.parse(e):Y.test(e)?Y.parse(e):q.test(e)?q.parse(e):e},transform:function(e){return H(e)?F.transform(e):W(e)?Y.transform(e):e}},J=function(e){var t=e.onRead,s=e.onRender,i=e.uncachedValues,r=void 0===i?new Set:i,n=e.useCache,o=void 0===n||n;return function(e){void 0===e&&(e={});var i=f(e,[]),n={},a=[],l=!1;function h(e,t){e.startsWith("--")&&(i.hasCSSVariable=!0);var s=n[e];n[e]=t,n[e]!==s&&(-1===a.indexOf(e)&&a.push(e),l||(l=!0,w.render(c.render)))}var c={get:function(e,s){return void 0===s&&(s=!1),!s&&o&&!r.has(e)&&void 0!==n[e]?n[e]:t(e,i)},set:function(e,t){if("string"==typeof e)h(e,t);else for(var s in e)h(s,e[s]);return this},render:function(e){return void 0===e&&(e=!1),(l||!0===e)&&(s(n,i,a),l=!1,a.length=0),this}};return c}},Q=/([a-z])([A-Z])/g,K=function(e){return e.replace(Q,"$1-$2").toLowerCase()},ee=new Map,te=new Map,se=["Webkit","Moz","O","ms",""],ie=se.length,re="undefined"!=typeof document,ne=function(e,t){return te.set(e,K(t))},oe=function(e,t){void 0===t&&(t=!1);var s=t?te:ee;return s.has(e)||(re?function(e){Z=Z||document.createElement("div");for(var t=0;t<ie;t++){var s=se[t],i=""===s,r=i?e:s+e.charAt(0).toUpperCase()+e.slice(1);if(r in Z.style||i){if(i&&"clipPath"===e&&te.has(e))return;ee.set(e,r),ne(e,(i?"":"-")+K(r))}}}(e):function(e){ne(e,e)}(e)),s.get(e)||e},ae=["","X","Y","Z"],le=["translate","scale","rotate","skew","transformPerspective"].reduce((function(e,t){return ae.reduce((function(e,s){return e.push(t+s),e}),e)}),["x","y","z"]),he=le.reduce((function(e,t){return e[t]=!0,e}),{});function ce(e){return!0===he[e]}function de(e,t){return le.indexOf(e)-le.indexOf(t)}var ue=new Set(["originX","originY","originZ"]);function fe(e){return ue.has(e)}var Ee=u(u({},M),{transform:Math.round}),me={color:U,backgroundColor:U,outlineColor:U,fill:U,stroke:U,borderColor:U,borderTopColor:U,borderRightColor:U,borderBottomColor:U,borderLeftColor:U,borderWidth:V,borderTopWidth:V,borderRightWidth:V,borderBottomWidth:V,borderLeftWidth:V,borderRadius:V,radius:V,borderTopLeftRadius:V,borderTopRightRadius:V,borderBottomRightRadius:V,borderBottomLeftRadius:V,width:V,maxWidth:V,height:V,maxHeight:V,size:V,top:V,right:V,bottom:V,left:V,padding:V,paddingTop:V,paddingRight:V,paddingBottom:V,paddingLeft:V,margin:V,marginTop:V,marginRight:V,marginBottom:V,marginLeft:V,rotate:k,rotateX:k,rotateY:k,rotateZ:k,scale:R,scaleX:R,scaleY:R,scaleZ:R,skew:k,skewX:k,skewY:k,distance:V,translateX:V,translateY:V,translateZ:V,x:V,y:V,z:V,perspective:V,opacity:S,originX:D,originY:D,originZ:V,zIndex:Ee,fillOpacity:S,strokeOpacity:S,numOctaves:Ee},pe=function(e){return me[e]},ve=function(e,t){return t&&"number"==typeof e?t.transform(e):e},xe=new Set(["scrollLeft","scrollTop"]),_e=new Set(["scrollLeft","scrollTop","transform"]),be={x:"translateX",y:"translateY",z:"translateZ"};function ge(e){return"function"==typeof e}function Te(e,t,s,i,r,n,o,a){void 0===t&&(t=!0),void 0===s&&(s={}),void 0===i&&(i={}),void 0===r&&(r={}),void 0===n&&(n=[]),void 0===o&&(o=!1),void 0===a&&(a=!0);var l=!0,h=!1,c=!1;for(var d in e){var u=e[d],f=pe(d),E=ve(u,f);ce(d)?(h=!0,i[d]=E,n.push(d),l&&(f.default&&u!==f.default||!f.default&&0!==u)&&(l=!1)):fe(d)?(r[d]=E,c=!0):_e.has(d)&&ge(E)||(s[oe(d,o)]=E)}return(h||"function"==typeof e.transform)&&(s.transform=function(e,t,s,i,r,n){void 0===n&&(n=!0);var o="",a=!1;s.sort(de);for(var l=s.length,h=0;h<l;h++){var c=s[h];o+=(be[c]||c)+"("+t[c]+") ",a="z"===c||a}return!a&&r?o+="translateZ(0)":o=o.trim(),ge(e.transform)?o=e.transform(t,i?"":o):n&&i&&(o="none"),o}(e,i,n,l,t,a)),c&&(s.transformOrigin=(r.originX||"50%")+" "+(r.originY||"50%")+" "+(r.originZ||0)),s}function ye(e){var t=void 0===e?{}:e,s=t.enableHardwareAcceleration,i=void 0===s||s,r=t.isDashCase,n=void 0===r||r,o=t.allowTransformNone,a=void 0===o||o,l={},h={},c={},d=[];return function(e){return d.length=0,Te(e,i,l,h,c,d,n,a),l}}var we=J({onRead:function(e,t){var s=t.element,i=t.preparseOutput,r=pe(e);if(ce(e))return r&&r.default||0;if(xe.has(e))return s[e];var n=window.getComputedStyle(s,null).getPropertyValue(oe(e,!0))||0;return i&&r&&r.test(n)&&r.parse?r.parse(n):n},onRender:function(e,t,s){var i=t.element,r=t.buildStyles,n=t.hasCSSVariable;if(Object.assign(i.style,r(e)),n)for(var o=s.length,a=0;a<o;a++){var l=s[a];l.startsWith("--")&&i.style.setProperty(l,e[l])}-1!==s.indexOf("scrollLeft")&&(i.scrollLeft=e.scrollLeft),-1!==s.indexOf("scrollTop")&&(i.scrollTop=e.scrollTop)},uncachedValues:xe});var Be=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),Le=function(e,t){return V.transform(e*t)},Ce={x:0,y:0,width:0,height:0};function Ne(e,t,s){return"string"==typeof e?e:V.transform(t+s*e)}var $e={enableHardwareAcceleration:!1,isDashCase:!1};function Oe(e,t,s,i,r,n){void 0===t&&(t=Ce),void 0===i&&(i=ye($e)),void 0===r&&(r={style:{}}),void 0===n&&(n=!0);var o=e.attrX,a=e.attrY,l=e.originX,h=e.originY,c=e.pathLength,d=e.pathSpacing,u=void 0===d?1:d,E=e.pathOffset,m=void 0===E?0:E,p=i(f(e,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]));for(var v in p){if("transform"===v)r.style.transform=p[v];else r[n&&!Be.has(v)?K(v):v]=p[v]}return(void 0!==l||void 0!==h||p.transform)&&(r.style.transformOrigin=function(e,t,s){return Ne(t,e.x,e.width)+" "+Ne(s,e.y,e.height)}(t,void 0!==l?l:.5,void 0!==h?h:.5)),void 0!==o&&(r.x=o),void 0!==a&&(r.y=a),void 0!==s&&void 0!==c&&(r[n?"stroke-dashoffset":"strokeDashoffset"]=Le(-m,s),r[n?"stroke-dasharray":"strokeDasharray"]=Le(c,s)+" "+Le(u,s)),r}function ze(e,t,s){void 0===s&&(s=!0);var i={style:{}},r=ye($e);return function(n){return Oe(n,e,t,r,i,s)}}var Me=J({onRead:function(e,t){var s=t.element;if(ce(e=Be.has(e)?e:K(e))){var i=pe(e);return i&&i.default||0}return s.getAttribute(e)},onRender:function(e,t){var s=t.element,i=(0,t.buildAttrs)(e);for(var r in i)"style"===r?Object.assign(s.style,i.style):s.setAttribute(r,i[r])}}),Se=J({useCache:!1,onRead:function(e){return"scrollTop"===e?window.pageYOffset:window.pageXOffset},onRender:function(e){var t=e.scrollTop,s=void 0===t?0:t,i=e.scrollLeft,r=void 0===i?0:i;return window.scrollTo(r,s)}}),Re=new WeakMap,Ae=function(e,t){var s,i,r,n;return e===window?s=Se(e):!function(e){return e instanceof HTMLElement||"function"==typeof e.click}(e)?function(e){return e instanceof SVGElement||"ownerSVGElement"in e}(e)&&(r=function(e){try{return function(e){return"function"==typeof e.getBBox?e.getBBox():e.getBoundingClientRect()}(e)}catch(t){return{x:0,y:0,width:0,height:0}}}(i=e),n=function(e){return"path"===e.tagName}(i)&&i.getTotalLength?i.getTotalLength():void 0,s=Me({element:i,buildAttrs:ze(r,n)})):s=function(e,t){void 0===t&&(t={});var s=t.enableHardwareAcceleration,i=t.allowTransformNone,r=f(t,["enableHardwareAcceleration","allowTransformNone"]);return we(u({element:e,buildStyles:ye({enableHardwareAcceleration:s,allowTransformNone:i}),preparseOutput:!0},r))}(e,t),Re.set(e,s),s};function ke(e,t){return function(e,t){return Re.has(e)?Re.get(e):Ae(e,t)}("string"==typeof e?document.querySelector(e):e,t)}var Xe=function(e,t,s,i){var r=s?s.call(i,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),l=0;l<n.length;l++){var h=n[l];if(!a(h))return!1;var c=e[h],d=t[h];if(!1===(r=s?s.call(i,c,d,h):void 0)||void 0===r&&c!==d)return!1}return!0};const Ve="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",De=Ve.length,Ie=Array(20),He=()=>{for(let e=0;e<20;e++)Ie[e]=Ve.charAt(Math.random()*De);return Ie.join("")};class We{constructor(){this.disposers=new Map}add(e,t=He()){return this.flush(t),this.disposers.set(t,e()),t}addDisposer(e,t=He()){return this.flush(t),this.disposers.set(t,e),t}addEventListener(e,t,s,i,r=He()){return this.add((()=>(e.addEventListener(t,s,i),()=>e.removeEventListener(t,s,i))),r),r}setTimeout(e,t,s=He()){return this.add((()=>{const i=window.setTimeout((()=>{this.remove(s),e()}),t);return()=>window.clearTimeout(i)}),s)}setInterval(e,t,s=He()){return this.add((()=>{const s=window.setInterval(e,t);return()=>window.clearInterval(s)}),s)}remove(e){const t=this.disposers.get(e);return this.disposers.delete(e),t}flush(e){const t=this.remove(e);if(t)try{t()}catch(s){console.error(s)}}flushAll(){this.disposers.forEach((e=>{try{e()}catch(t){console.error(t)}})),this.disposers.clear()}}var je=Object.defineProperty,Ge=("undefined"!=typeof require&&require,(e,t,s)=>{return n=s,(r="symbol"!=typeof t?t+"":t)in(i=e)?je(i,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[r]=n,s;var i,r,n});class Pe{constructor(e,t){Ge(this,"_value"),Ge(this,"_beforeDestroys"),Ge(this,"_subscribers"),this._value=e,t&&(this.compare=t)}get value(){return this._value}setValue(e,t){if(!this.compare(e,this._value)){const s=this._value;this._value=e,this._subscribers&&this._subscribers.forEach((i=>i(e,s,t)))}}reaction(e){return this._subscribers||(this._subscribers=new Set),this._subscribers.add(e),()=>{this._subscribers&&this._subscribers.delete(e)}}subscribe(e,t){const s=this.reaction(e);return e(this._value,void 0,t),s}derive(e,t,s){const i=new Pe(e(this.value,void 0,s),t),r=this.reaction(((t,s,r)=>{i.setValue(e(t,s,r))}));return i.addBeforeDestroy(r),i}destroy(){this._beforeDestroys&&(this._beforeDestroys.forEach((e=>e())),this._beforeDestroys.clear()),this._subscribers&&this._subscribers.clear()}addBeforeDestroy(e){return this._beforeDestroys||(this._beforeDestroys=new Set),this._beforeDestroys.add(e),()=>{this._beforeDestroys&&this._beforeDestroys.delete(e)}}compare(e,t){return e===t}}function Ze(e,t){Object.keys(t).forEach((s=>{!function(e,t,s){var i;Object.defineProperties(e,{[t]:{get:()=>s.value},[`_${t}$`]:{value:s},[`set${i=t,i[0].toUpperCase()+i.slice(1)}`]:{value:(e,t)=>s.setValue(e,t)}})}(e,s,t[s])}))}function Fe(e){const t=t=>{const s=e.addDisposer((()=>{t.destroy()}));return t.addBeforeDestroy((()=>{e.remove(s)})),t};return{bindSideEffect:t,combine:(e,s,i,r)=>t(function(e,t,s,i){let r=e.map((e=>e.value));const n=new Pe(t(r,void 0,i),s);return e.forEach(((e,s)=>{const i=e.reaction(((e,i,o)=>{const a=r.slice();a[s]=e;const l=r;r=a,n.setValue(t(a,l,o),o)}));n.addBeforeDestroy(i)})),n}(e,s,i,r)),createVal:(e,s)=>t(new Pe(e,s))}}var Ye,qe,Ue,Je,Qe;exports.TELE_BOX_COLOR_SCHEME=void 0,(Ye=exports.TELE_BOX_COLOR_SCHEME||(exports.TELE_BOX_COLOR_SCHEME={})).Light="light",Ye.Dark="dark",Ye.Auto="auto",exports.TELE_BOX_STATE=void 0,(qe=exports.TELE_BOX_STATE||(exports.TELE_BOX_STATE={})).Normal="normal",qe.Minimized="minimized",qe.Maximized="maximized",exports.TELE_BOX_EVENT=void 0,(Ue=exports.TELE_BOX_EVENT||(exports.TELE_BOX_EVENT={})).DarkMode="dark_mode",Ue.PrefersColorScheme="prefers_color_scheme",Ue.Close="close",Ue.Focus="focus",Ue.Blur="blur",Ue.Move="move",Ue.Resize="resize",Ue.IntrinsicMove="intrinsic_move",Ue.IntrinsicResize="intrinsic_resize",Ue.VisualResize="visual_resize",Ue.State="state",Ue.Minimized="minimized",Ue.Maximized="maximized",Ue.Readonly="readonly",Ue.Destroyed="destroyed",exports.TELE_BOX_DELEGATE_EVENT=void 0,(Je=exports.TELE_BOX_DELEGATE_EVENT||(exports.TELE_BOX_DELEGATE_EVENT={})).Close="close",Je.Maximize="maximize",Je.Minimize="minimize",exports.TELE_BOX_RESIZE_HANDLE=void 0,(Qe=exports.TELE_BOX_RESIZE_HANDLE||(exports.TELE_BOX_RESIZE_HANDLE={})).North="n",Qe.South="s",Qe.West="w",Qe.East="e",Qe.NorthWest="nw",Qe.NorthEast="ne",Qe.SouthEast="se",Qe.SouthWest="sw";function Ke(e,t,s){return Math.min(Math.max(e,t),s)}function et(e){e.stopPropagation(),e.cancelable&&e.preventDefault()}function tt(e){return e.touches?e.touches[0]:e}function st(){return Date.now().toString().slice(6)+Math.random().toString().slice(2,8)}let it=1;function rt(){return"New Box "+it++}function nt(e){return Boolean(e)}function ot(e){return!e}class at{constructor({readonly:e=!1,title:t,buttons:s,onEvent:i,onDragStart:r,namespace:n="telebox",state:o=exports.TELE_BOX_STATE.Normal}={}){this.$btns=[],this.sideEffect=new We,this.lastTitleBarClick=0,this.handleTitleBarClick=e=>{var t;if(this.readonly)return;if(null!=e.button&&0!==e.button)return;if(null==(t=e.target.dataset)?void 0:t.teleTitleBarNoDblClick)return;et(e);const s=Date.now();s-this.lastTitleBarClick<=500?this.onEvent&&this.onEvent({type:exports.TELE_BOX_DELEGATE_EVENT.Maximize}):this.onDragStart&&this.onDragStart(e),this.lastTitleBarClick=s},this.readonly=e,this.onEvent=i,this.onDragStart=r,this.namespace=n,this.title=t,this.state=o,this.buttons=s||[{type:exports.TELE_BOX_DELEGATE_EVENT.Minimize,iconClassName:this.wrapClassName("titlebar-icon-minimize")},{type:exports.TELE_BOX_DELEGATE_EVENT.Maximize,iconClassName:this.wrapClassName("titlebar-icon-maximize"),isActive:e=>e===exports.TELE_BOX_STATE.Maximized},{type:exports.TELE_BOX_DELEGATE_EVENT.Close,iconClassName:this.wrapClassName("titlebar-icon-close")}]}setTitle(e){this.title=e,this.$title&&(this.$title.textContent=e,this.$title.title=e)}setState(e){this.state!==e&&(this.state=e,this.buttons.forEach(((t,s)=>{t.isActive&&this.$btns[s].classList.toggle("is-active",t.isActive(e))})))}setReadonly(e){this.readonly!==e&&(this.readonly=e)}render(){if(!this.$titleBar){this.$titleBar=document.createElement("div"),this.$titleBar.className=this.wrapClassName("titlebar"),this.$titleBar.dataset.teleBoxHandle="dh",this.sideEffect.addEventListener(this.$titleBar,"mousedown",this.handleTitleBarClick),this.sideEffect.addEventListener(this.$titleBar,"touchstart",this.handleTitleBarClick,{passive:!0}),this.$title=document.createElement("h1"),this.$title.className=this.wrapClassName("title"),this.$title.dataset.teleBoxHandle="dh",this.title&&(this.$title.textContent=this.title,this.$title.title=this.title);const e=document.createElement("div");e.className=this.wrapClassName("titlebar-btns"),this.buttons.forEach((({iconClassName:t,isActive:s},i)=>{const r=String(i),n=document.createElement("button");n.className=`${this.wrapClassName("titlebar-btn")} ${t}`,n.dataset.teleTitleBarBtnIndex=r,n.dataset.teleTitleBarNoDblClick="true",s&&n.classList.toggle("is-active",s(this.state)),this.$btns.push(n),e.appendChild(n)})),this.sideEffect.addEventListener(e,"click",(e=>{var t;if(this.readonly)return;const s=e.target,i=Number(null==(t=s.dataset)?void 0:t.teleTitleBarBtnIndex);if(!Number.isNaN(i)&&i<this.buttons.length){et(e);const t=this.buttons[i];this.onEvent&&this.onEvent({type:t.type,value:t.value})}})),this.$titleBar.appendChild(this.$title),this.$titleBar.appendChild(e)}return this.$titleBar}dragHandle(){return this.$titleBar}wrapClassName(e){return`${this.namespace}-${e}`}destroy(){this.sideEffect.flushAll(),this.$titleBar&&(this.$titleBar=void 0,this.$title=void 0,this.$btns.length=0,this.onDragStart=void 0,this.onEvent=void 0)}}class lt{constructor({id:e=st(),title:t=rt(),prefersColorScheme:s=exports.TELE_BOX_COLOR_SCHEME.Light,darkMode:i,visible:r=!0,width:n=.5,height:o=.5,minWidth:a=0,minHeight:l=0,x:h=.1,y:c=.1,minimized:u=!1,maximized:f=!1,readonly:E=!1,resizable:m=!0,draggable:p=!0,fence:v=!0,fixRatio:x=!1,focus:_=!1,zIndex:b=100,namespace:g="telebox",titleBar:T,content:y,footer:w,styles:B,containerRect:L={x:0,y:0,width:window.innerWidth,height:window.innerHeight},collectorRect:C}={}){this._renderSideEffect=new We,this.handleTrackStart=e=>{var t;return null==(t=this._handleTrackStart)?void 0:t.call(this,e)},this._sideEffect=new We,this._valSideEffectBinder=Fe(this._sideEffect);const{combine:N,createVal:$}=this._valSideEffectBinder;this.id=e,this.namespace=g,this.events=new d,this._delegateEvents=new d;const O=$(s);O.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.PrefersColorScheme,e)}));const z=$(Boolean(i));null==i&&O.subscribe(((e,t,s)=>{this._sideEffect.add((()=>{if("auto"===e){const e=window.matchMedia("(prefers-color-scheme: dark)");if(e){z.setValue(e.matches,s);const t=e=>{z.setValue(e.matches,s)};return e.addListener(t),()=>e.removeListener(t)}return ht}return z.setValue("dark"===e,s),ht}),"prefers-color-scheme")})),z.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.DarkMode,e)}));const M=$(L,Xe),S=$(C,Xe),R=$(t),A=$(r);A.reaction(((e,t,s)=>{s||e||this.events.emit(exports.TELE_BOX_EVENT.Close)}));const k=$(E);k.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.Readonly,e)}));const X=$(m),V=$(p),D=$(v),I=$(x),H=$(b),W=$(_);W.reaction(((e,t,s)=>{s||this.events.emit(e?exports.TELE_BOX_EVENT.Focus:exports.TELE_BOX_EVENT.Blur)}));const j=$(u);j.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.Minimized,e)}));const G=$(f);G.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.Maximized,e)}));const P=N([j,G],(([e,t])=>e?exports.TELE_BOX_STATE.Minimized:t?exports.TELE_BOX_STATE.Maximized:exports.TELE_BOX_STATE.Normal));P.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.State,e)}));const Z=$({width:Ke(a,0,1),height:Ke(l,0,1)},Xe),F=$({width:Ke(n,Z.value.width,1),height:Ke(o,Z.value.height,1)},Xe);Z.reaction(((e,t,s)=>{F.setValue({width:Ke(n,e.width,1),height:Ke(o,e.height,1)},s)})),F.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.IntrinsicResize,e)}));const Y=N([F,G],(([e,t])=>t?{width:1,height:1}:e),Xe);Y.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.Resize,e)}));const q=N([Y,j,M,S],(([e,t,s,i])=>t&&i?{width:i.width/e.width/s.width,height:i.height/e.height/s.height}:e),Xe);q.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.VisualResize,e)}));const U=$({x:Ke(h,0,1),y:Ke(c,0,1)},Xe);U.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.IntrinsicMove,e)}));const J=N([U,F,M,S,j,G],(([e,t,s,i,r,n])=>r&&i?n?{x:(i.x+i.width/2)/s.width-.5,y:(i.y+i.height/2)/s.height-.5}:{x:(i.x+i.width/2)/s.width-t.width/2,y:(i.y+i.height/2)/s.height-t.height/2}:n?{x:0,y:0}:e),Xe);J.reaction(((e,t,s)=>{s||this.events.emit(exports.TELE_BOX_EVENT.Move,e)})),this.titleBar=T||new at({readonly:k.value,title:R.value,namespace:this.namespace,onDragStart:e=>{var t;return null==(t=this._handleTrackStart)?void 0:t.call(this,e)},onEvent:e=>{if(this._delegateEvents.listeners.length>0)this._delegateEvents.emit(e.type);else switch(e.type){case exports.TELE_BOX_DELEGATE_EVENT.Maximize:G.setValue(!G.value);break;case exports.TELE_BOX_DELEGATE_EVENT.Minimize:j.setValue(!0);break;case exports.TELE_BOX_DELEGATE_EVENT.Close:A.setValue(!1);break;default:console.error("Unsupported titleBar event:",e)}}}),k.reaction((e=>{this.titleBar.setReadonly(e)}));const Q=$(y),K=$(w),ee=$(B);Ze(this,{prefersColorScheme:O,darkMode:z,containerRect:M,collectorRect:S,title:R,visible:A,readonly:k,resizable:X,draggable:V,fence:D,fixRatio:I,focus:W,zIndex:H,minimized:j,maximized:G,$userContent:Q,$userFooter:K,$userStyles:ee}),this._state$=P,this._minSize$=Z,this._size$=Y,this._intrinsicSize$=F,this._visualSize$=q,this._coord$=J,this._intrinsicCoord$=U,this.fixRatio&&this.transform(J.value.x,J.value.y,Y.value.width,Y.value.height,!0),this.$box=this.render()}get darkMode(){return this._darkMode$.value}get state(){return this._state$.value}setState(e,t=!1){switch(e){case exports.TELE_BOX_STATE.Maximized:this.setMinimized(!1,t),this.setMaximized(!0,t);break;case exports.TELE_BOX_STATE.Minimized:this.setMinimized(!0,t),this.setMaximized(!1,t);break;default:this.setMinimized(!1,t),this.setMaximized(!1,t)}return this}get minWidth(){return this._minSize$.value.width}get minHeight(){return this._minSize$.value.height}setMinWidth(e,t=!1){return this._minSize$.setValue({width:e,height:this.minHeight},t),this}setMinHeight(e,t=!1){return this._minSize$.setValue({width:this.minWidth,height:e},t),this}get intrinsicWidth(){return this._intrinsicSize$.value.width}get intrinsicHeight(){return this._intrinsicSize$.value.height}resize(e,t,s=!1){return this._intrinsicSize$.setValue({width:e,height:t},s),this}get width(){return this._size$.value.width}get height(){return this._size$.value.height}get absoluteWidth(){return this.width*this.containerRect.width}get absoluteHeight(){return this.height*this.containerRect.height}get visualWidth(){return this._visualSize$.value.width}get visualHeight(){return this._visualSize$.value.height}get intrinsicX(){return this._intrinsicCoord$.value.x}get intrinsicY(){return this._intrinsicCoord$.value.y}move(e,t,s=!1){return this._intrinsicCoord$.setValue({x:e,y:t},s),this}get x(){return this._coord$.value.x}get y(){return this._coord$.value.y}transform(e,t,s,i,r=!1){if(this.fixRatio){const e=this.intrinsicHeight/this.intrinsicWidth*s;t!==this.intrinsicY&&(t-=e-i),i=e}return t<0&&(t=0,i>this.intrinsicHeight&&(i=this.intrinsicHeight)),this._intrinsicCoord$.setValue({x:s>=this.minWidth?e:this.intrinsicX,y:i>=this.minHeight?t:this.intrinsicY},r),this._intrinsicSize$.setValue({width:Ke(s,this.minWidth,1),height:Ke(i,this.minHeight,1)},r),this}mount(e){return e.appendChild(this.render()),this}unmount(){return this.$box&&this.$box.remove(),this}mountContent(e){return this.set$userContent(e),this}unmountContent(){return this.set$userContent(void 0),this}mountFooter(e){return this.set$userFooter(e),this}unmountFooter(){return this.set$userFooter(void 0),this}getUserStyles(){return this.$userStyles}mountStyles(e){let t;return"string"==typeof e?(t=document.createElement("style"),t.textContent=e):t=e,this.set$userStyles(t),this}unmountStyles(){return this.set$userStyles(void 0),this}render(e){if(e){if(e===this.$box)return this.$box;this.$box=e}else{if(this.$box)return this.$box;this.$box=document.createElement("div")}this._renderSideEffect.flushAll(),this.$box.classList.add(this.wrapClassName("box"));const t=(e,t,s,i=nt)=>this._renderSideEffect.add((()=>{const r=this.wrapClassName(s);return t.subscribe((t=>{e.classList.toggle(r,i(t))}))}));t(this.$box,this._readonly$,"readonly"),t(this.$box,this._draggable$,"no-drag",ot),t(this.$box,this._resizable$,"no-resize",ot),t(this.$box,this._focus$,"blur",ot),t(this.$box,this._darkMode$,"color-scheme-dark"),t(this.$box,this._darkMode$,"color-scheme-light",ot),this._renderSideEffect.add((()=>{const e=this.wrapClassName("minimized"),t=this.wrapClassName("maximized"),s="box-maximized-timer";return this._state$.subscribe((i=>{this.$box.classList.toggle(e,i===exports.TELE_BOX_STATE.Minimized),i===exports.TELE_BOX_STATE.Maximized?(this._renderSideEffect.flush(s),this.$box.classList.toggle(t,!0)):this._renderSideEffect.setTimeout((()=>{this.$box.classList.toggle(t,!1)}),0,s)}))})),this._renderSideEffect.add((()=>this._visible$.subscribe((e=>{this.$box.style.display=e?"block":"none"})))),this._renderSideEffect.add((()=>this._zIndex$.subscribe((e=>{this.$box.style.zIndex=String(e)}))));const s=ke(this.$box);this.$box.dataset.teleBoxID=this.id,this.$box.style.width=this.absoluteWidth+"px",this.$box.style.height=this.absoluteHeight+"px";const i=this.x*this.containerRect.width+this.containerRect.x,r=this.y*this.containerRect.height+this.containerRect.y;this.$box.style.transform=`translate(${i-10}px,${r-10}px)`,this._valSideEffectBinder.combine([this._coord$,this._size$,this._minimized$,this._containerRect$,this._collectorRect$],(([e,t,s,i,r])=>{const n=t.width*i.width,o=t.height*i.height;return{width:n,height:o,x:e.x*i.width,y:e.y*i.height,scaleX:s&&r?r.width/n:1,scaleY:s&&r?r.height/o:1}}),Xe).subscribe((e=>{s.set(e)})),s.set({x:i,y:r});const n=document.createElement("div");n.className=this.wrapClassName("box-main"),this.$box.appendChild(n);const o=document.createElement("div");o.className=this.wrapClassName("titlebar-wrap"),o.appendChild(this.titleBar.render()),this.$titleBar=o;const a=document.createElement("div");a.className=this.wrapClassName("content-wrap");const l=document.createElement("div");l.className=this.wrapClassName("content")+" tele-fancy-scrollbar",this.$content=l,this._renderSideEffect.add((()=>{let e;return this._$userStyles$.subscribe((t=>{e&&e.remove(),e=t,t&&l.appendChild(t)}))})),this._renderSideEffect.add((()=>{let e;return this._$userContent$.subscribe((t=>{e&&e.remove(),e=t,t&&l.appendChild(t)}))})),a.appendChild(l);const h=document.createElement("div");return h.className=this.wrapClassName("footer-wrap"),this.$footer=h,this._renderSideEffect.add((()=>{let e;return this._$userFooter$.subscribe((t=>{e&&e.remove(),e=t,t&&h.appendChild(t)}))})),n.appendChild(o),n.appendChild(a),n.appendChild(h),this._renderResizeHandlers(),this.$box}_renderResizeHandlers(){const e=document.createElement("div");e.className=this.wrapClassName("resize-handles"),Object.values(exports.TELE_BOX_RESIZE_HANDLE).forEach((t=>{const s=document.createElement("div");s.className=this.wrapClassName(t)+" "+this.wrapClassName("resize-handle"),s.dataset.teleBoxHandle=t,e.appendChild(s)})),this.$box.appendChild(e);const t="handle-tracking-listener",s=this.wrapClassName("transforming");let i,r,n=0,o=0,a=0,l=0,h=0,c=0;const d=e=>{if(this.state!==exports.TELE_BOX_STATE.Normal)return;et(e);let{pageX:t,pageY:s}=tt(e);s<0&&(s=0);const i=(t-h)/this.containerRect.width,d=(s-c)/this.containerRect.height;switch(r){case exports.TELE_BOX_RESIZE_HANDLE.North:this.transform(this.x,o+d,this.width,l-d);break;case exports.TELE_BOX_RESIZE_HANDLE.South:this.transform(this.x,this.y,this.width,l+d);break;case exports.TELE_BOX_RESIZE_HANDLE.West:this.transform(n+i,this.y,a-i,this.height);break;case exports.TELE_BOX_RESIZE_HANDLE.East:this.transform(this.x,this.y,a+i,this.height);break;case exports.TELE_BOX_RESIZE_HANDLE.NorthWest:this.transform(n+i,o+d,a-i,l-d);break;case exports.TELE_BOX_RESIZE_HANDLE.NorthEast:this.transform(this.x,o+d,a+i,l-d);break;case exports.TELE_BOX_RESIZE_HANDLE.SouthEast:this.transform(this.x,this.y,a+i,l+d);break;case exports.TELE_BOX_RESIZE_HANDLE.SouthWest:this.transform(n+i,this.y,a-i,l+d);break;default:if(this.fence)this.move(Ke(n+i,0,1-this.width),Ke(o+d,0,1-this.height));else{const e=20/this.containerRect.width,t=20/this.containerRect.height;this.move(Ke(n+i,e-this.width,1-e),Ke(o+d,0,1-t))}}},u=e=>{r=void 0,i&&(et(e),this.$box.classList.toggle(s,!1),this._sideEffect.flush(t),i.remove())},f=e=>{var f;if(this.readonly)return;if(null!=e.button&&0!==e.button)return;if(!this.draggable||r||this.state!==exports.TELE_BOX_STATE.Normal)return;const E=e.target;if(null==(f=E.dataset)?void 0:f.teleBoxHandle){et(e),n=this.x,o=this.y,a=this.width,l=this.height,({pageX:h,pageY:c}=tt(e)),r=E.dataset.teleBoxHandle,i||(i=document.createElement("div"));const f=r?this.wrapClassName(`cursor-${r}`):"";i.className=this.wrapClassName("track-mask"+(f?` ${f}`:"")),this.$box.appendChild(i),this.$box.classList.add(s),this._sideEffect.add((()=>(window.addEventListener("mousemove",d),window.addEventListener("touchmove",d,{passive:!1}),window.addEventListener("mouseup",u),window.addEventListener("touchend",u,{passive:!1}),window.addEventListener("touchcancel",u,{passive:!1}),()=>{window.removeEventListener("mousemove",d),window.removeEventListener("touchmove",d),window.removeEventListener("mouseup",u),window.removeEventListener("touchend",u),window.removeEventListener("touchcancel",u)})),t)}};this._handleTrackStart=f,this._sideEffect.addEventListener(e,"mousedown",f,{},"box-resizeHandles-mousedown"),this._sideEffect.addEventListener(e,"touchstart",f,{passive:!1},"box-resizeHandles-touchstart")}destroy(){this.$box.remove(),this.events.emit(exports.TELE_BOX_EVENT.Destroyed),this._sideEffect.flushAll(),this._renderSideEffect.flushAll(),this.events.removeAllListeners(),this._delegateEvents.removeAllListeners()}wrapClassName(e){return`${this.namespace}-${e}`}}function ht(){}const ct=(e,t)=>{const s=a.useRef(!0);a.useEffect((()=>{if(!s.current)return e();s.current=!1}),t)};var dt;class ut{constructor({visible:e=!0,readonly:t=!1,darkMode:s=!1,namespace:i="telebox",styles:r={},onClick:n}={}){this.handleCollectorClick=()=>{!this._readonly&&this.onClick&&this.onClick()},this._visible=e,this._readonly=t,this._darkMode=s,this.namespace=i,this.styles=r,this.onClick=n}get visible(){return this._visible}get readonly(){return this._readonly}get darkMode(){return this._darkMode}mount(e){return e.appendChild(this.render()),this}unmount(){return this.$collector&&this.$collector.remove(),this}setVisible(e){return this._visible!==e&&(this._visible=e,this.$collector&&this.$collector.classList.toggle(this.wrapClassName("collector-visible"),e)),this}setReadonly(e){return this._readonly!==e&&(this._readonly=e,this.$collector&&this.$collector.classList.toggle(this.wrapClassName("collector-readonly"),e)),this}setDarkMode(e){return this._darkMode!==e&&(this._darkMode=e,this.$collector&&(this.$collector.classList.toggle(this.wrapClassName("color-scheme-dark"),e),this.$collector.classList.toggle(this.wrapClassName("color-scheme-light"),!e))),this}setStyles(e){if(Object.assign(this.styles,e),this.$collector){const t=this.$collector;Object.keys(e).forEach((s=>{const i=e[s];null!=i&&(t.style[s]=i)}))}return this}render(){return this.$collector||(this.$collector=document.createElement("button"),this.$collector.className=this.wrapClassName("collector"),this.$collector.style.backgroundImage="url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOCAxNiI+CiAgICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIHN0cm9rZT0iIzdCODhBMCIgc3Ryb2tlLXdpZHRoPSIxLjQiIGQ9Ik0uNyAxLjJoMTYuNnYxMy42SC43eiIgLz4KICAgICAgICA8cGF0aCBmaWxsPSIjN0I4OEEwIiBkPSJNNCA1LjVoNnYxLjRINHpNNCA5LjVoMTB2MS40SDR6IiAvPgogICAgPC9nPgo8L3N2Zz4K')",this.$collector.addEventListener("click",this.handleCollectorClick),this._visible&&this.$collector.classList.add(this.wrapClassName("collector-visible")),this._readonly&&this.$collector.classList.add(this.wrapClassName("collector-readonly")),this.$collector.classList.add(this.wrapClassName(this._darkMode?"color-scheme-dark":"color-scheme-light")),this.setStyles(this.styles)),this.$collector}destroy(){this.$collector&&(this.$collector.removeEventListener("click",this.handleCollectorClick),this.$collector.remove(),this.$collector=void 0),this.onClick=void 0}wrapClassName(e){return`${this.namespace}-${e}`}}exports.TELE_BOX_MANAGER_EVENT=void 0,(dt=exports.TELE_BOX_MANAGER_EVENT||(exports.TELE_BOX_MANAGER_EVENT={})).Focused="focused",dt.Created="created",dt.Removed="removed",dt.State="state",dt.Maximized="maximized",dt.Minimized="minimized",dt.Move="move",dt.Resize="resize",dt.IntrinsicMove="intrinsic_move",dt.IntrinsicResize="intrinsic_resize",dt.VisualResize="visual_resize",dt.PrefersColorScheme="prefers_color_scheme",dt.DarkMode="dark_mode";class ft extends at{constructor(e){super(e),this.boxes=e.boxes,this.focusedBox=e.focusedBox,this.containerRect=e.containerRect,this.darkMode=e.darkMode}focusBox(e){var t;if(e||(e=this.boxes[this.boxes.length-1]),!this.focusedBox||this.focusedBox!==e){if(this.$titles&&this.state===exports.TELE_BOX_STATE.Maximized){const{children:s}=this.$titles.firstElementChild;for(let i=s.length-1;i>=0;i-=1){const r=s[i],n=null==(t=r.dataset)?void 0:t.teleBoxID;n&&(e&&n===e.id?r.classList.toggle(this.wrapClassName("titles-tab-focus"),!0):this.focusedBox&&n===this.focusedBox.id&&r.classList.toggle(this.wrapClassName("titles-tab-focus"),!1))}}this.focusedBox=e}}setContainerRect(e){if(this.containerRect=e,this.$titleBar){const{x:t,y:s,width:i}=e;this.$titleBar.style.transform=`translate(${t}px, ${s}px)`,this.$titleBar.style.width=i+"px"}}setBoxes(e){this.boxes=e,this.updateTitles()}setState(e){super.setState(e),this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("max-titlebar-maximized"),e===exports.TELE_BOX_STATE.Maximized),this.updateTitles()}setReadonly(e){super.setReadonly(e),this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("readonly"),this.readonly)}setDarkMode(e){e!==this.darkMode&&(this.darkMode=e,this.$titleBar&&(this.$titleBar.classList.toggle(this.wrapClassName("color-scheme-dark"),e),this.$titleBar.classList.toggle(this.wrapClassName("color-scheme-light"),!e)))}render(){const e=super.render(),{x:t,y:s,width:i}=this.containerRect;return e.style.transform=`translate(${t}px, ${s}px)`,e.style.width=i+"px",e.classList.add(this.wrapClassName("max-titlebar")),e.classList.toggle(this.wrapClassName("max-titlebar-maximized"),this.state===exports.TELE_BOX_STATE.Maximized),e.classList.toggle(this.wrapClassName("readonly"),this.readonly),e.classList.add(this.wrapClassName(this.darkMode?"color-scheme-dark":"color-scheme-light")),this.updateTitles(),e}destroy(){super.destroy(),this.$titles=void 0,this.boxes.length=0,this.focusedBox=void 0}updateTitles(){this.$titleBar&&this.state===exports.TELE_BOX_STATE.Maximized&&(1===this.boxes.length?this.$title&&(this.$title.textContent=this.boxes[0].title,this.$titleBar.replaceChild(this.$title,this.$titleBar.firstElementChild)):this.$titleBar.replaceChild(this.renderTitles(),this.$titleBar.firstElementChild))}renderTitles(){this.$titles=document.createElement("div"),this.$titles.className=this.wrapClassName("titles"),this.$titles.addEventListener("wheel",(e=>{e.currentTarget.scrollBy({left:e.deltaY>0?250:-250,behavior:"smooth"})}),{passive:!1});const e=document.createElement("div");return e.className=this.wrapClassName("titles-content"),this.$titles.appendChild(e),this.boxes.forEach((t=>{const s=document.createElement("button");s.className=this.wrapClassName("titles-tab"),s.textContent=t.title,s.dataset.teleBoxID=t.id,s.dataset.teleTitleBarNoDblClick="true",this.focusedBox&&t.id===this.focusedBox.id&&s.classList.add(this.wrapClassName("titles-tab-focus")),e.appendChild(s)})),this.$titles}}exports.DefaultTitleBar=at,exports.TeleBox=lt,exports.TeleBoxCollector=ut,exports.TeleBoxDragHandleType="dh",exports.TeleBoxManager=class{constructor({root:e=document.body,prefersColorScheme:t=exports.TELE_BOX_COLOR_SCHEME.Light,minimized:s=!1,maximized:i=!1,fence:r=!0,containerRect:n={x:0,y:0,width:window.innerWidth,height:window.innerHeight},collector:o,namespace:a="telebox",zIndex:l=100,readonly:h=!1}={}){this.events=new d,this.boxes=[],this._sideEffect=new We;const{combine:c,createVal:u}=Fe(this._sideEffect);this.root=e,this.namespace=a,this.zIndex=l;const f=window.matchMedia("(prefers-color-scheme: dark)"),E=u(!1);f&&(E.setValue(f.matches),this._sideEffect.add((()=>{const e=e=>{E.setValue(e.matches)};return f.addListener(e),()=>f.removeListener(e)})));const m=u(t);m.reaction(((e,t,s)=>{this.boxes.forEach((t=>t.setPrefersColorScheme(e,s))),s||this.events.emit(exports.TELE_BOX_MANAGER_EVENT.PrefersColorScheme,e)})),this._darkMode$=c([E,m],(([e,t])=>"auto"===t?e:"dark"===t)),this._darkMode$.reaction(((e,t,s)=>{this.boxes.forEach((t=>t.setDarkMode(e,s))),s||this.events.emit(exports.TELE_BOX_MANAGER_EVENT.DarkMode,e)}));const p=u(h);p.reaction(((e,t,s)=>{this.boxes.forEach((t=>t.setReadonly(e,s)))}));const v=u(s),x=u(i);x.reaction(((e,t,s)=>{this.boxes.forEach((t=>t.setMaximized(e,s))),s||this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Maximized,e)}));const _=c([v,x],(([e,t])=>e?exports.TELE_BOX_STATE.Minimized:t?exports.TELE_BOX_STATE.Maximized:exports.TELE_BOX_STATE.Normal));_.reaction(((e,t,s)=>{this.maxTitleBar.setState(e),s||this.events.emit(exports.TELE_BOX_MANAGER_EVENT.State,e)}));const b=u(r);b.subscribe(((e,t,s)=>{this.boxes.forEach((t=>t.setFence(e,s)))}));const g=u(n,Xe);g.reaction(((e,t,s)=>{this.boxes.forEach((t=>t.setContainerRect(e,s))),this.maxTitleBar.setContainerRect(e)}));const T=u(null===o?null:o||new ut({visible:s,readonly:h,namespace:a}).mount(e));T.subscribe((e=>{e&&(e.setVisible(v.value),e.setReadonly(p.value),e.setDarkMode(this._darkMode$.value),this._sideEffect.add((()=>(e.onClick=()=>{p.value||v.setValue(!1)},()=>e.destroy())),"collect-onClick"))})),p.subscribe((e=>{var t;return null==(t=T.value)?void 0:t.setReadonly(e)})),this._darkMode$.subscribe((e=>{var t;null==(t=T.value)||t.setDarkMode(e)})),v.subscribe(((e,t,s)=>{var i,r;if(null==(i=T.value)||i.setVisible(e),e&&(null==(r=T.value)?void 0:r.$collector)){const{x:e,y:t,width:s,height:i}=T.value.$collector.getBoundingClientRect(),r=this.root.getBoundingClientRect();this.boxes.forEach((n=>{n.setCollectorRect({x:e-r.x,y:t-r.y,width:s,height:i},!0)}))}this.boxes.forEach((t=>t.setMinimized(e,s))),s||this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Minimized,e)}));const y=e=>{var t;if(p.value)return;const s=e.target;if(s.tagName)for(let i=s;i;i=i.parentElement){const e=null==(t=i.dataset)?void 0:t.teleBoxID;if(e){const t=this.boxes.find((t=>t.id===e));if(t)return void this.focusBox({focus:!0,box:t})}}};this._sideEffect.addEventListener(window,"mousedown",y,!0),this._sideEffect.addEventListener(window,"touchstart",y,!0),this.maxTitleBar=new ft({darkMode:this.darkMode,readonly:p.value,namespace:this.namespace,state:_.value,boxes:this.boxes,focusedBox:this._focusedBox,containerRect:g.value,onEvent:e=>{var t;switch(e.type){case exports.TELE_BOX_DELEGATE_EVENT.Maximize:x.setValue(!x.value);break;case exports.TELE_BOX_DELEGATE_EVENT.Minimize:v.setValue(!0);break;case exports.TELE_BOX_EVENT.Close:{const e=null!=(t=this._focusedBox)?t:this.boxes[this.boxes.length-1];e&&this.remove(e.id);break}}}}),p.subscribe((e=>this.maxTitleBar.setReadonly(e))),this._darkMode$.subscribe((e=>{this.maxTitleBar.setDarkMode(e)}));Ze(this,{prefersColorScheme:m,containerRect:g,collector:T,readonly:p,fence:b,minimized:v,maximized:x}),this._state$=_,this.root.appendChild(this.maxTitleBar.render())}get darkMode(){return this._darkMode$.value}get state(){return this._state$.value}setState(e,t=!1){switch(e){case exports.TELE_BOX_STATE.Maximized:this.setMinimized(!1,t),this.setMaximized(!0,t);break;case exports.TELE_BOX_STATE.Minimized:this.setMinimized(!0,t),this.setMaximized(!1,t);break;default:this.setMinimized(!1,t),this.setMaximized(!1,t)}return this}create(e){const t=new lt(this.wrapCreateConfig(e));return t.mount(this.root),this.boxes.push(t),t.focus&&this.focusBox({focus:!0,box:t,increaseZIndex:!1}),this.maxTitleBar.setBoxes(this.boxes),t._delegateEvents.on(exports.TELE_BOX_DELEGATE_EVENT.Maximize,(()=>{this.setMaximized(!this.maximized)})),t._delegateEvents.on(exports.TELE_BOX_DELEGATE_EVENT.Minimize,(()=>{this.setMinimized(!0)})),t._delegateEvents.on(exports.TELE_BOX_DELEGATE_EVENT.Close,(()=>{this.focusBox({focus:!1,box:t}),this.remove(t.id)})),t.events.on(exports.TELE_BOX_EVENT.Move,(()=>{this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Move,t)})),t.events.on(exports.TELE_BOX_EVENT.Resize,(()=>{this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Resize,t)})),t.events.on(exports.TELE_BOX_EVENT.IntrinsicMove,(()=>{this.events.emit(exports.TELE_BOX_MANAGER_EVENT.IntrinsicMove,t)})),t.events.on(exports.TELE_BOX_EVENT.IntrinsicResize,(()=>{this.events.emit(exports.TELE_BOX_MANAGER_EVENT.IntrinsicResize,t)})),t.events.on(exports.TELE_BOX_EVENT.VisualResize,(()=>{this.events.emit(exports.TELE_BOX_MANAGER_EVENT.VisualResize,t)})),this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Created,t),t}query(e){return e?this.boxes.filter(this.teleBoxMatcher(e)):[...this.boxes]}queryOne(e){return e?this.boxes.find(this.teleBoxMatcher(e)):this.boxes[0]}update(e,t,s=!1){const i=this.boxes.find((t=>t.id===e));if(i)return this.updateBox(i,t,s)}updateAll(e,t=!1){this.boxes.forEach((s=>{this.updateBox(s,e,t)}))}remove(e,t=!1){const s=this.boxes.findIndex((t=>t.id===e));if(s>=0){const e=this.boxes.splice(s,1);this.maxTitleBar.setBoxes(this.boxes);const i=e[0];return this.focusBox({focus:!1,box:i}),i.destroy(),t||(this.boxes.length<=0&&(this.setMaximized(!1),this.setMinimized(!1)),this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Removed,e)),i}}removeAll(e=!1){if(this._focusedBox){const t=this._focusedBox;this._focusedBox=void 0,e||this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Focused,void 0,t)}const t=this.boxes.splice(0,this.boxes.length);return this.maxTitleBar.setBoxes(this.boxes),t.forEach((e=>e.destroy())),e||(this.boxes.length<=0&&(this.setMaximized(!1),this.setMinimized(!1)),this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Removed,t)),t}destroy(e=!1){this.events.removeAllListeners(),this._sideEffect.flushAll(),this._focusedBox=void 0,this.removeAll(e),Object.keys(this).forEach((e=>{const t=this[e];t instanceof Pe&&t.destroy()}))}wrapClassName(e){return`${this.namespace}-${e}`}teleBoxMatcher(e){const t=Object.keys(e);return s=>t.every((t=>e[t]===s[t]))}updateBox(e,t,s=!1){null==t.x&&null==t.y||e.move(null==t.x?e.intrinsicX:t.x,null==t.y?e.intrinsicY:t.y,s),null==t.width&&null==t.height||e.resize(null==t.width?e.intrinsicWidth:t.width,null==t.height?e.intrinsicHeight:t.height,s),null!=t.title&&(e.setTitle(t.title),this.maxTitleBar.updateTitles()),null!=t.visible&&e.setVisible(t.visible,s),null!=t.minHeight&&e.setMinHeight(t.minHeight,s),null!=t.minWidth&&e.setMinWidth(t.minWidth,s),null!=t.resizable&&e.setResizable(t.resizable),null!=t.draggable&&e.setDraggable(t.draggable),null!=t.fixRatio&&e.setFixRatio(t.fixRatio,s),null!=t.focus&&this.focusBox({focus:t.focus,box:e,skipUpdate:s}),null!=t.content&&e.mountContent(t.content),null!=t.footer&&e.mountFooter(t.footer)}focusBox({focus:e,box:t,skipUpdate:s=!1,increaseZIndex:i=!0}){if(t.setFocus(e,s),t.focus){if(this._focusedBox!==t){const e=this._focusedBox;this._focusedBox&&this._focusedBox.setFocus(!1,s),this._focusedBox=t,i&&t.setZIndex(++this.zIndex),s||this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Focused,t,e)}}else this._focusedBox===t&&(this._focusedBox=void 0,s||this.events.emit(exports.TELE_BOX_MANAGER_EVENT.Focused,void 0,t));this.maxTitleBar.focusBox(this._focusedBox)}getInitialPosition(e,t){const s=this.boxes.length>0&&this.boxes.reduce(((e,t)=>e.zIndex>t.zIndex?e:t));let i=20,r=20;return s&&(i=s.intrinsicX*this.containerRect.width+20,r=s.intrinsicY*this.containerRect.height+20,(i>this.containerRect.width-e*this.containerRect.width||r>this.containerRect.height-t*this.containerRect.height)&&(i=20,r=20)),{x:i/this.containerRect.width,y:r/this.containerRect.height}}wrapCreateConfig(e={}){let{x:a,y:l}=e;const{width:h=.5,height:c=.5}=e;if(null==a||null==l){const e=this.getInitialPosition(h,c);null==a&&(a=e.x),null==l&&(l=e.y)}return d=((e,t)=>{for(var s in t||(t={}))r.call(t,s)&&o(e,s,t[s]);if(i)for(var s of i(t))n.call(t,s)&&o(e,s,t[s]);return e})({},e),u={x:a,y:l,width:h,height:c,darkMode:this.darkMode,prefersColorScheme:this.prefersColorScheme,maximized:this.maximized,minimized:this.minimized,fence:this.fence,zIndex:this.zIndex,namespace:this.namespace,containerRect:this.containerRect,readonly:this.readonly},t(d,s(u));var d,u}},exports.TeleBoxReact=e=>{const[t]=a.useState((()=>new lt(e)));return ct((()=>{null!=e.prefersColorScheme&&t.setPrefersColorScheme(e.prefersColorScheme)}),[t,e.prefersColorScheme]),ct((()=>{null!=e.minWidth&&t.setMinWidth(e.minWidth)}),[t,e.minWidth]),ct((()=>{null!=e.minHeight&&t.setMinHeight(e.minHeight)}),[t,e.minHeight]),ct((()=>{var s,i;t.resize(null!=(s=e.width)?s:t.width,null!=(i=e.height)?i:t.height,!0)}),[t,e.width,e.height]),ct((()=>{var s,i;t.move(null!=(s=e.x)?s:t.x,null!=(i=e.y)?i:t.y,!0)}),[t,e.x,e.y]),ct((()=>{null!=e.title&&t.setTitle(e.title)}),[t,e.title]),ct((()=>{null!=e.visible&&t.setVisible(e.visible)}),[t,e.visible]),ct((()=>{null!=e.minimized&&t.setMinimized(e.minimized,!0)}),[t,e.minimized]),ct((()=>{null!=e.maximized&&t.setMaximized(e.maximized,!0)}),[t,e.maximized]),ct((()=>{null!=e.state&&t.setState(e.state,!0)}),[t,e.state]),ct((()=>{null!=e.draggable&&t.setDraggable(e.draggable)}),[t,e.draggable]),ct((()=>{null!=e.resizable&&t.setResizable(e.resizable)}),[t,e.resizable]),ct((()=>{null!=e.fence&&t.setFence(e.fence)}),[t,e.fence]),ct((()=>{null!=e.containerRect&&t.setContainerRect(e.containerRect)}),[t,e.containerRect]),ct((()=>{null!=e.fixRatio&&t.setFixRatio(e.fixRatio)}),[t,e.fixRatio]),a.useEffect((()=>{if(e.onResize)return t.events.on(exports.TELE_BOX_EVENT.Resize,e.onResize),()=>{t.events.off(exports.TELE_BOX_EVENT.Resize,e.onResize)}}),[t,e.onResize]),a.useEffect((()=>{if(e.onMove)return t.events.on(exports.TELE_BOX_EVENT.Move,e.onMove),()=>{t.events.off(exports.TELE_BOX_EVENT.Move,e.onMove)}}),[t,e.onMove]),a.useEffect((()=>{if(e.onClose)return t.events.on(exports.TELE_BOX_EVENT.Close,e.onClose),()=>{t.events.off(exports.TELE_BOX_EVENT.Close,e.onClose)}}),[t,e.onClose]),a.useEffect((()=>{if(e.onFocus)return t.events.on(exports.TELE_BOX_EVENT.Focus,e.onFocus),()=>{t.events.off(exports.TELE_BOX_EVENT.Focus,e.onFocus)}}),[t,e.onFocus]),a.useEffect((()=>{if(e.onBlur)return t.events.on(exports.TELE_BOX_EVENT.Blur,e.onBlur),()=>{t.events.off(exports.TELE_BOX_EVENT.Blur,e.onBlur)}}),[t,e.onBlur]),a.useEffect((()=>{if(e.onStateChanged)return t.events.on(exports.TELE_BOX_EVENT.State,e.onStateChanged),()=>{t.events.off(exports.TELE_BOX_EVENT.State,e.onStateChanged)}}),[t,e.onStateChanged]),h.default.createElement("div",{ref:e=>e&&t.render(e),className:t.wrapClassName("box")})};
//# sourceMappingURL=telebox-insider.cjs.js.map
