var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s;import a,{useRef as l,useEffect as h,useState as c}from"react";var d={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,i="~";function s(){}function r(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function n(e,t,s,n,o){if("function"!=typeof s)throw new TypeError("The listener must be a function");var a=new r(s,n||e,o),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new s:delete e._events[t]}function a(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),a.prototype.eventNames=function(){var e,s,r=[];if(0===this._eventsCount)return r;for(s in e=this._events)t.call(e,s)&&r.push(i?s.slice(1):s);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},a.prototype.listeners=function(e){var t=i?i+e:e,s=this._events[t];if(!s)return[];if(s.fn)return[s.fn];for(var r=0,n=s.length,o=new Array(n);r<n;r++)o[r]=s[r].fn;return o},a.prototype.listenerCount=function(e){var t=i?i+e:e,s=this._events[t];return s?s.fn?1:s.length:0},a.prototype.emit=function(e,t,s,r,n,o){var a=i?i+e:e;if(!this._events[a])return!1;var l,h,c=this._events[a],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,s),!0;case 4:return c.fn.call(c.context,t,s,r),!0;case 5:return c.fn.call(c.context,t,s,r,n),!0;case 6:return c.fn.call(c.context,t,s,r,n,o),!0}for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var u,f=c.length;for(h=0;h<f;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),d){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,s);break;case 4:c[h].fn.call(c[h].context,t,s,r);break;default:if(!l)for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c[h].fn.apply(c[h].context,l)}}return!0},a.prototype.on=function(e,t,i){return n(this,e,t,i,!1)},a.prototype.once=function(e,t,i){return n(this,e,t,i,!0)},a.prototype.removeListener=function(e,t,s,r){var n=i?i+e:e;if(!this._events[n])return this;if(!t)return o(this,n),this;var a=this._events[n];if(a.fn)a.fn!==t||r&&!a.once||s&&a.context!==s||o(this,n);else{for(var l=0,h=[],c=a.length;l<c;l++)(a[l].fn!==t||r&&!a[l].once||s&&a[l].context!==s)&&h.push(a[l]);h.length?this._events[n]=1===h.length?h[0]:h:o(this,n)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&o(this,t)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,e.exports=a}(d);var u=d.exports,f=function(){return(f=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function m(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(i[s[r]]=e[s[r]])}return i}var v=0,p="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(e){return window.requestAnimationFrame(e)}:function(e){var t=Date.now(),i=Math.max(0,16.7-(t-v));v=t+i,setTimeout((function(){return e(v)}),i)},b=1/60*1e3,g=!0,x=!1,y=!1,w={delta:0,timestamp:0},C=["read","update","preRender","render","postRender"],$=function(e){return x=e},_=C.reduce((function(e,t){var i,s,r,n,o,a,l,h,c;return e[t]=(i=$,s=[],r=[],n=0,o=!1,a=0,l=new WeakSet,h=new WeakSet,c={cancel:function(e){var t=r.indexOf(e);l.add(e),-1!==t&&r.splice(t,1)},process:function(e){var t,d;if(o=!0,s=(t=[r,s])[0],(r=t[1]).length=0,n=s.length)for(a=0;a<n;a++)(d=s[a])(e),!0!==h.has(d)||l.has(d)||(c.schedule(d),i(!0));o=!1},schedule:function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var a=i&&o,c=a?s:r;l.delete(e),t&&h.add(e),-1===c.indexOf(e)&&(c.push(e),a&&(n=s.length))}}),e}),{}),z=C.reduce((function(e,t){var i=_[t];return e[t]=function(e,t,s){return void 0===t&&(t=!1),void 0===s&&(s=!1),x||E(),i.schedule(e,t,s),e},e}),{}),M=function(e){return _[e].process(w)},B=function(e){x=!1,w.delta=g?b:Math.max(Math.min(e-w.timestamp,40),1),g||(b=w.delta),w.timestamp=e,y=!0,C.forEach(M),y=!1,x&&(g=!1,p(B))},E=function(){x=!0,g=!0,y||p(B)},k=function(){return(k=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},S=function(e,t){return function(i){return Math.max(Math.min(i,t),e)}},R=function(e){return e%1?Number(e.toFixed(5)):e},N=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i,L={test:function(e){return"number"==typeof e},parse:parseFloat,transform:function(e){return e}},O=k(k({},L),{transform:S(0,1)}),I=k(k({},L),{default:1}),T=function(e){return{test:function(t){return"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length},parse:parseFloat,transform:function(t){return""+t+e}}},D=T("deg"),A=T("%"),H=T("px"),W=k(k({},A),{parse:function(e){return A.parse(e)/100},transform:function(e){return A.transform(100*e)}}),V=S(0,255),j=function(e){return void 0!==e.red},P=function(e){return void 0!==e.hue};var F=function(e){return function(t){if("string"!=typeof t)return t;for(var i={},s=function(e){return e.substring(e.indexOf("(")+1,e.lastIndexOf(")"))}(t).replace(/(,|\/)/g," ").split(/ \s*/),r=0;r<4;r++)i[e[r]]=void 0!==s[r]?parseFloat(s[r]):1;return i}},Y=k(k({},L),{transform:function(e){return Math.round(V(e))}});function X(e,t){return e.startsWith(t)&&N.test(e)}var Z,q={test:function(e){return"string"==typeof e?X(e,"rgb"):j(e)},parse:F(["red","green","blue","alpha"]),transform:function(e){var t=e.red,i=e.green,s=e.blue,r=e.alpha,n=void 0===r?1:r;return function(e){var t=e.red,i=e.green,s=e.blue,r=e.alpha;return"rgba("+t+", "+i+", "+s+", "+(void 0===r?1:r)+")"}({red:Y.transform(t),green:Y.transform(i),blue:Y.transform(s),alpha:R(O.transform(n))})}},U={test:function(e){return"string"==typeof e?X(e,"hsl"):P(e)},parse:F(["hue","saturation","lightness","alpha"]),transform:function(e){var t=e.hue,i=e.saturation,s=e.lightness,r=e.alpha,n=void 0===r?1:r;return function(e){var t=e.hue,i=e.saturation,s=e.lightness,r=e.alpha;return"hsla("+t+", "+i+", "+s+", "+(void 0===r?1:r)+")"}({hue:Math.round(t),saturation:A.transform(R(i)),lightness:A.transform(R(s)),alpha:R(O.transform(n))})}},G=k(k({},q),{test:function(e){return"string"==typeof e&&X(e,"#")},parse:function(e){var t="",i="",s="";return e.length>4?(t=e.substr(1,2),i=e.substr(3,2),s=e.substr(5,2)):(t=e.substr(1,1),i=e.substr(2,1),s=e.substr(3,1),t+=t,i+=i,s+=s),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(s,16),alpha:1}}}),J={test:function(e){return"string"==typeof e&&N.test(e)||j(e)||P(e)},parse:function(e){return q.test(e)?q.parse(e):U.test(e)?U.parse(e):G.test(e)?G.parse(e):e},transform:function(e){return j(e)?q.transform(e):P(e)?U.transform(e):e}},Q=function(e){var t=e.onRead,i=e.onRender,s=e.uncachedValues,r=void 0===s?new Set:s,n=e.useCache,o=void 0===n||n;return function(e){void 0===e&&(e={});var s=m(e,[]),n={},a=[],l=!1;function h(e,t){e.startsWith("--")&&(s.hasCSSVariable=!0);var i=n[e];n[e]=t,n[e]!==i&&(-1===a.indexOf(e)&&a.push(e),l||(l=!0,z.render(c.render)))}var c={get:function(e,i){return void 0===i&&(i=!1),!i&&o&&!r.has(e)&&void 0!==n[e]?n[e]:t(e,s)},set:function(e,t){if("string"==typeof e)h(e,t);else for(var i in e)h(i,e[i]);return this},render:function(e){return void 0===e&&(e=!1),(l||!0===e)&&(i(n,s,a),l=!1,a.length=0),this}};return c}},K=/([a-z])([A-Z])/g,ee=function(e){return e.replace(K,"$1-$2").toLowerCase()},te=new Map,ie=new Map,se=["Webkit","Moz","O","ms",""],re=se.length,ne="undefined"!=typeof document,oe=function(e,t){return ie.set(e,ee(t))},ae=function(e,t){void 0===t&&(t=!1);var i=t?ie:te;return i.has(e)||(ne?function(e){Z=Z||document.createElement("div");for(var t=0;t<re;t++){var i=se[t],s=""===i,r=s?e:i+e.charAt(0).toUpperCase()+e.slice(1);if(r in Z.style||s){if(s&&"clipPath"===e&&ie.has(e))return;te.set(e,r),oe(e,(s?"":"-")+ee(r))}}}(e):function(e){oe(e,e)}(e)),i.get(e)||e},le=["","X","Y","Z"],he=["translate","scale","rotate","skew","transformPerspective"].reduce((function(e,t){return le.reduce((function(e,i){return e.push(t+i),e}),e)}),["x","y","z"]),ce=he.reduce((function(e,t){return e[t]=!0,e}),{});function de(e){return!0===ce[e]}function ue(e,t){return he.indexOf(e)-he.indexOf(t)}var fe=new Set(["originX","originY","originZ"]);function me(e){return fe.has(e)}var ve=f(f({},L),{transform:Math.round}),pe={color:J,backgroundColor:J,outlineColor:J,fill:J,stroke:J,borderColor:J,borderTopColor:J,borderRightColor:J,borderBottomColor:J,borderLeftColor:J,borderWidth:H,borderTopWidth:H,borderRightWidth:H,borderBottomWidth:H,borderLeftWidth:H,borderRadius:H,radius:H,borderTopLeftRadius:H,borderTopRightRadius:H,borderBottomRightRadius:H,borderBottomLeftRadius:H,width:H,maxWidth:H,height:H,maxHeight:H,size:H,top:H,right:H,bottom:H,left:H,padding:H,paddingTop:H,paddingRight:H,paddingBottom:H,paddingLeft:H,margin:H,marginTop:H,marginRight:H,marginBottom:H,marginLeft:H,rotate:D,rotateX:D,rotateY:D,rotateZ:D,scale:I,scaleX:I,scaleY:I,scaleZ:I,skew:D,skewX:D,skewY:D,distance:H,translateX:H,translateY:H,translateZ:H,x:H,y:H,z:H,perspective:H,opacity:O,originX:W,originY:W,originZ:H,zIndex:ve,fillOpacity:O,strokeOpacity:O,numOctaves:ve},be=function(e){return pe[e]},ge=function(e,t){return t&&"number"==typeof e?t.transform(e):e},xe=new Set(["scrollLeft","scrollTop"]),ye=new Set(["scrollLeft","scrollTop","transform"]),we={x:"translateX",y:"translateY",z:"translateZ"};function Ce(e){return"function"==typeof e}function $e(e,t,i,s,r,n,o,a){void 0===t&&(t=!0),void 0===i&&(i={}),void 0===s&&(s={}),void 0===r&&(r={}),void 0===n&&(n=[]),void 0===o&&(o=!1),void 0===a&&(a=!0);var l=!0,h=!1,c=!1;for(var d in e){var u=e[d],f=be(d),m=ge(u,f);de(d)?(h=!0,s[d]=m,n.push(d),l&&(f.default&&u!==f.default||!f.default&&0!==u)&&(l=!1)):me(d)?(r[d]=m,c=!0):ye.has(d)&&Ce(m)||(i[ae(d,o)]=m)}return(h||"function"==typeof e.transform)&&(i.transform=function(e,t,i,s,r,n){void 0===n&&(n=!0);var o="",a=!1;i.sort(ue);for(var l=i.length,h=0;h<l;h++){var c=i[h];o+=(we[c]||c)+"("+t[c]+") ",a="z"===c||a}return!a&&r?o+="translateZ(0)":o=o.trim(),Ce(e.transform)?o=e.transform(t,s?"":o):n&&s&&(o="none"),o}(e,s,n,l,t,a)),c&&(i.transformOrigin=(r.originX||"50%")+" "+(r.originY||"50%")+" "+(r.originZ||0)),i}function _e(e){var t=void 0===e?{}:e,i=t.enableHardwareAcceleration,s=void 0===i||i,r=t.isDashCase,n=void 0===r||r,o=t.allowTransformNone,a=void 0===o||o,l={},h={},c={},d=[];return function(e){return d.length=0,$e(e,s,l,h,c,d,n,a),l}}var ze=Q({onRead:function(e,t){var i=t.element,s=t.preparseOutput,r=be(e);if(de(e))return r&&r.default||0;if(xe.has(e))return i[e];var n=window.getComputedStyle(i,null).getPropertyValue(ae(e,!0))||0;return s&&r&&r.test(n)&&r.parse?r.parse(n):n},onRender:function(e,t,i){var s=t.element,r=t.buildStyles,n=t.hasCSSVariable;if(Object.assign(s.style,r(e)),n)for(var o=i.length,a=0;a<o;a++){var l=i[a];l.startsWith("--")&&s.style.setProperty(l,e[l])}-1!==i.indexOf("scrollLeft")&&(s.scrollLeft=e.scrollLeft),-1!==i.indexOf("scrollTop")&&(s.scrollTop=e.scrollTop)},uncachedValues:xe});var Me=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),Be=function(e,t){return H.transform(e*t)},Ee={x:0,y:0,width:0,height:0};function ke(e,t,i){return"string"==typeof e?e:H.transform(t+i*e)}var Se={enableHardwareAcceleration:!1,isDashCase:!1};function Re(e,t,i,s,r,n){void 0===t&&(t=Ee),void 0===s&&(s=_e(Se)),void 0===r&&(r={style:{}}),void 0===n&&(n=!0);var o=e.attrX,a=e.attrY,l=e.originX,h=e.originY,c=e.pathLength,d=e.pathSpacing,u=void 0===d?1:d,f=e.pathOffset,v=void 0===f?0:f,p=s(m(e,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]));for(var b in p){if("transform"===b)r.style.transform=p[b];else r[n&&!Me.has(b)?ee(b):b]=p[b]}return(void 0!==l||void 0!==h||p.transform)&&(r.style.transformOrigin=function(e,t,i){return ke(t,e.x,e.width)+" "+ke(i,e.y,e.height)}(t,void 0!==l?l:.5,void 0!==h?h:.5)),void 0!==o&&(r.x=o),void 0!==a&&(r.y=a),void 0!==i&&void 0!==c&&(r[n?"stroke-dashoffset":"strokeDashoffset"]=Be(-v,i),r[n?"stroke-dasharray":"strokeDasharray"]=Be(c,i)+" "+Be(u,i)),r}function Ne(e,t,i){void 0===i&&(i=!0);var s={style:{}},r=_e(Se);return function(n){return Re(n,e,t,r,s,i)}}var Le=Q({onRead:function(e,t){var i=t.element;if(de(e=Me.has(e)?e:ee(e))){var s=be(e);return s&&s.default||0}return i.getAttribute(e)},onRender:function(e,t){var i=t.element,s=(0,t.buildAttrs)(e);for(var r in s)"style"===r?Object.assign(i.style,s.style):i.setAttribute(r,s[r])}}),Oe=Q({useCache:!1,onRead:function(e){return"scrollTop"===e?window.pageYOffset:window.pageXOffset},onRender:function(e){var t=e.scrollTop,i=void 0===t?0:t,s=e.scrollLeft,r=void 0===s?0:s;return window.scrollTo(r,i)}}),Ie=new WeakMap,Te=function(e,t){var i,s,r,n;return e===window?i=Oe(e):!function(e){return e instanceof HTMLElement||"function"==typeof e.click}(e)?function(e){return e instanceof SVGElement||"ownerSVGElement"in e}(e)&&(r=function(e){try{return function(e){return"function"==typeof e.getBBox?e.getBBox():e.getBoundingClientRect()}(e)}catch(t){return{x:0,y:0,width:0,height:0}}}(s=e),n=function(e){return"path"===e.tagName}(s)&&s.getTotalLength?s.getTotalLength():void 0,i=Le({element:s,buildAttrs:Ne(r,n)})):i=function(e,t){void 0===t&&(t={});var i=t.enableHardwareAcceleration,s=t.allowTransformNone,r=m(t,["enableHardwareAcceleration","allowTransformNone"]);return ze(f({element:e,buildStyles:_e({enableHardwareAcceleration:i,allowTransformNone:s}),preparseOutput:!0},r))}(e,t),Ie.set(e,i),i};function De(e,t){return function(e,t){return Ie.has(e)?Ie.get(e):Te(e,t)}("string"==typeof e?document.querySelector(e):e,t)}var Ae=function(e,t,i,s){var r=i?i.call(s,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),l=0;l<n.length;l++){var h=n[l];if(!a(h))return!1;var c=e[h],d=t[h];if(!1===(r=i?i.call(s,c,d,h):void 0)||void 0===r&&c!==d)return!1}return!0};const He="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",We=He.length,Ve=Array(20),je=()=>{for(let e=0;e<20;e++)Ve[e]=He.charAt(Math.random()*We);return Ve.join("")};class Pe{constructor(){this.disposers=new Map}add(e,t=je()){return this.flush(t),this.disposers.set(t,e()),t}addDisposer(e,t=je()){return this.flush(t),this.disposers.set(t,e),t}addEventListener(e,t,i,s,r=je()){return this.add((()=>(e.addEventListener(t,i,s),()=>e.removeEventListener(t,i,s))),r),r}setTimeout(e,t,i=je()){return this.add((()=>{const s=window.setTimeout((()=>{this.remove(i),e()}),t);return()=>window.clearTimeout(s)}),i)}setInterval(e,t,i=je()){return this.add((()=>{const i=window.setInterval(e,t);return()=>window.clearInterval(i)}),i)}remove(e){const t=this.disposers.get(e);return this.disposers.delete(e),t}flush(e){const t=this.remove(e);if(t)try{t()}catch(i){console.error(i)}}flushAll(){this.disposers.forEach((e=>{try{e()}catch(t){console.error(t)}})),this.disposers.clear()}}var Fe=Object.defineProperty,Ye=("undefined"!=typeof require&&require,(e,t,i)=>{return n=i,(r="symbol"!=typeof t?t+"":t)in(s=e)?Fe(s,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[r]=n,i;var s,r,n});class Xe{constructor(e,t){Ye(this,"_value"),Ye(this,"_beforeDestroys"),Ye(this,"_subscribers"),this._value=e,t&&(this.compare=t)}get value(){return this._value}setValue(e,t){if(!this.compare(e,this._value)){const i=this._value;this._value=e,this._subscribers&&this._subscribers.forEach((s=>s(e,i,t)))}}reaction(e){return this._subscribers||(this._subscribers=new Set),this._subscribers.add(e),()=>{this._subscribers&&this._subscribers.delete(e)}}subscribe(e,t){const i=this.reaction(e);return e(this._value,void 0,t),i}derive(e,t,i){const s=new Xe(e(this.value,void 0,i),t),r=this.reaction(((t,i,r)=>{s.setValue(e(t,i,r))}));return s.addBeforeDestroy(r),s}destroy(){this._beforeDestroys&&(this._beforeDestroys.forEach((e=>e())),this._beforeDestroys.clear()),this._subscribers&&this._subscribers.clear()}addBeforeDestroy(e){return this._beforeDestroys||(this._beforeDestroys=new Set),this._beforeDestroys.add(e),()=>{this._beforeDestroys&&this._beforeDestroys.delete(e)}}compare(e,t){return e===t}}function Ze(e,t){Object.keys(t).forEach((i=>{!function(e,t,i){var s;Object.defineProperties(e,{[t]:{get:()=>i.value},[`_${t}$`]:{value:i},[`set${s=t,s[0].toUpperCase()+s.slice(1)}`]:{value:(e,t)=>i.setValue(e,t)}})}(e,i,t[i])}))}function qe(e){const t=t=>{const i=e.addDisposer((()=>{t.destroy()}));return t.addBeforeDestroy((()=>{e.remove(i)})),t};return{bindSideEffect:t,combine:(e,i,s,r)=>t(function(e,t,i,s){let r=e.map((e=>e.value));const n=new Xe(t(r,void 0,s),i);return e.forEach(((e,i)=>{const s=e.reaction(((e,s,o)=>{const a=r.slice();a[i]=e;const l=r;r=a,n.setValue(t(a,l,o),o)}));n.addBeforeDestroy(s)})),n}(e,i,s,r)),createVal:(e,i)=>t(new Xe(e,i))}}var Ue,Ge,Je,Qe,Ke,et,tt,it,st,rt;(Ge=Ue||(Ue={})).Light="light",Ge.Dark="dark",Ge.Auto="auto",(Qe=Je||(Je={})).Normal="normal",Qe.Minimized="minimized",Qe.Maximized="maximized",(et=Ke||(Ke={})).DarkMode="dark_mode",et.PrefersColorScheme="prefers_color_scheme",et.Close="close",et.Focus="focus",et.Blur="blur",et.Move="move",et.Resize="resize",et.IntrinsicMove="intrinsic_move",et.IntrinsicResize="intrinsic_resize",et.VisualResize="visual_resize",et.State="state",et.Minimized="minimized",et.Maximized="maximized",et.Readonly="readonly",et.Destroyed="destroyed",(it=tt||(tt={})).Close="close",it.Maximize="maximize",it.Minimize="minimize",(rt=st||(st={})).North="n",rt.South="s",rt.West="w",rt.East="e",rt.NorthWest="nw",rt.NorthEast="ne",rt.SouthEast="se",rt.SouthWest="sw";const nt="dh";function ot(e,t,i){return Math.min(Math.max(e,t),i)}function at(e){e.stopPropagation(),e.cancelable&&e.preventDefault()}function lt(e){return e.touches?e.touches[0]:e}function ht(){return Date.now().toString().slice(6)+Math.random().toString().slice(2,8)}let ct=1;function dt(){return"New Box "+ct++}function ut(e){return Boolean(e)}function ft(e){return!e}class mt{constructor({readonly:e=!1,title:t,buttons:i,onEvent:s,onDragStart:r,namespace:n="telebox",state:o=Je.Normal}={}){this.$btns=[],this.sideEffect=new Pe,this.lastTitleBarClick=0,this.handleTitleBarClick=e=>{var t;if(this.readonly)return;if(null!=e.button&&0!==e.button)return;if(null==(t=e.target.dataset)?void 0:t.teleTitleBarNoDblClick)return;at(e);const i=Date.now();i-this.lastTitleBarClick<=500?this.onEvent&&this.onEvent({type:tt.Maximize}):this.onDragStart&&this.onDragStart(e),this.lastTitleBarClick=i},this.readonly=e,this.onEvent=s,this.onDragStart=r,this.namespace=n,this.title=t,this.state=o,this.buttons=i||[{type:tt.Minimize,iconClassName:this.wrapClassName("titlebar-icon-minimize")},{type:tt.Maximize,iconClassName:this.wrapClassName("titlebar-icon-maximize"),isActive:e=>e===Je.Maximized},{type:tt.Close,iconClassName:this.wrapClassName("titlebar-icon-close")}]}setTitle(e){this.title=e,this.$title&&(this.$title.textContent=e,this.$title.title=e)}setState(e){this.state!==e&&(this.state=e,this.buttons.forEach(((t,i)=>{t.isActive&&this.$btns[i].classList.toggle("is-active",t.isActive(e))})))}setReadonly(e){this.readonly!==e&&(this.readonly=e)}render(){if(!this.$titleBar){this.$titleBar=document.createElement("div"),this.$titleBar.className=this.wrapClassName("titlebar"),this.$titleBar.dataset.teleBoxHandle="dh",this.sideEffect.addEventListener(this.$titleBar,"mousedown",this.handleTitleBarClick),this.sideEffect.addEventListener(this.$titleBar,"touchstart",this.handleTitleBarClick,{passive:!0}),this.$title=document.createElement("h1"),this.$title.className=this.wrapClassName("title"),this.$title.dataset.teleBoxHandle="dh",this.title&&(this.$title.textContent=this.title,this.$title.title=this.title);const e=document.createElement("div");e.className=this.wrapClassName("titlebar-btns"),this.buttons.forEach((({iconClassName:t,isActive:i},s)=>{const r=String(s),n=document.createElement("button");n.className=`${this.wrapClassName("titlebar-btn")} ${t}`,n.dataset.teleTitleBarBtnIndex=r,n.dataset.teleTitleBarNoDblClick="true",i&&n.classList.toggle("is-active",i(this.state)),this.$btns.push(n),e.appendChild(n)})),this.sideEffect.addEventListener(e,"click",(e=>{var t;if(this.readonly)return;const i=e.target,s=Number(null==(t=i.dataset)?void 0:t.teleTitleBarBtnIndex);if(!Number.isNaN(s)&&s<this.buttons.length){at(e);const t=this.buttons[s];this.onEvent&&this.onEvent({type:t.type,value:t.value})}})),this.$titleBar.appendChild(this.$title),this.$titleBar.appendChild(e)}return this.$titleBar}dragHandle(){return this.$titleBar}wrapClassName(e){return`${this.namespace}-${e}`}destroy(){this.sideEffect.flushAll(),this.$titleBar&&(this.$titleBar=void 0,this.$title=void 0,this.$btns.length=0,this.onDragStart=void 0,this.onEvent=void 0)}}class vt{constructor({id:e=ht(),title:t=dt(),prefersColorScheme:i=Ue.Light,darkMode:s,visible:r=!0,width:n=.5,height:o=.5,minWidth:a=0,minHeight:l=0,x:h=.1,y:c=.1,minimized:d=!1,maximized:f=!1,readonly:m=!1,resizable:v=!0,draggable:p=!0,fence:b=!0,fixRatio:g=!1,focus:x=!1,zIndex:y=100,namespace:w="telebox",titleBar:C,content:$,footer:_,styles:z,containerRect:M={x:0,y:0,width:window.innerWidth,height:window.innerHeight},collectorRect:B}={}){this._renderSideEffect=new Pe,this.handleTrackStart=e=>{var t;return null==(t=this._handleTrackStart)?void 0:t.call(this,e)},this._sideEffect=new Pe,this._valSideEffectBinder=qe(this._sideEffect);const{combine:E,createVal:k}=this._valSideEffectBinder;this.id=e,this.namespace=w,this.events=new u,this._delegateEvents=new u;const S=k(i);S.reaction(((e,t,i)=>{i||this.events.emit(Ke.PrefersColorScheme,e)}));const R=k(Boolean(s));null==s&&S.subscribe(((e,t,i)=>{this._sideEffect.add((()=>{if("auto"===e){const e=window.matchMedia("(prefers-color-scheme: dark)");if(e){R.setValue(e.matches,i);const t=e=>{R.setValue(e.matches,i)};return e.addListener(t),()=>e.removeListener(t)}return pt}return R.setValue("dark"===e,i),pt}),"prefers-color-scheme")})),R.reaction(((e,t,i)=>{i||this.events.emit(Ke.DarkMode,e)}));const N=k(M,Ae),L=k(B,Ae),O=k(t),I=k(r);I.reaction(((e,t,i)=>{i||e||this.events.emit(Ke.Close)}));const T=k(m);T.reaction(((e,t,i)=>{i||this.events.emit(Ke.Readonly,e)}));const D=k(v),A=k(p),H=k(b),W=k(g),V=k(y),j=k(x);j.reaction(((e,t,i)=>{i||this.events.emit(e?Ke.Focus:Ke.Blur)}));const P=k(d);P.reaction(((e,t,i)=>{i||this.events.emit(Ke.Minimized,e)}));const F=k(f);F.reaction(((e,t,i)=>{i||this.events.emit(Ke.Maximized,e)}));const Y=E([P,F],(([e,t])=>e?Je.Minimized:t?Je.Maximized:Je.Normal));Y.reaction(((e,t,i)=>{i||this.events.emit(Ke.State,e)}));const X=k({width:ot(a,0,1),height:ot(l,0,1)},Ae),Z=k({width:ot(n,X.value.width,1),height:ot(o,X.value.height,1)},Ae);X.reaction(((e,t,i)=>{Z.setValue({width:ot(n,e.width,1),height:ot(o,e.height,1)},i)})),Z.reaction(((e,t,i)=>{i||this.events.emit(Ke.IntrinsicResize,e)}));const q=E([Z,F],(([e,t])=>t?{width:1,height:1}:e),Ae);q.reaction(((e,t,i)=>{i||this.events.emit(Ke.Resize,e)}));const U=E([q,P,N,L],(([e,t,i,s])=>t&&s?{width:s.width/e.width/i.width,height:s.height/e.height/i.height}:e),Ae);U.reaction(((e,t,i)=>{i||this.events.emit(Ke.VisualResize,e)}));const G=k({x:ot(h,0,1),y:ot(c,0,1)},Ae);G.reaction(((e,t,i)=>{i||this.events.emit(Ke.IntrinsicMove,e)}));const J=E([G,Z,N,L,P,F],(([e,t,i,s,r,n])=>r&&s?n?{x:(s.x+s.width/2)/i.width-.5,y:(s.y+s.height/2)/i.height-.5}:{x:(s.x+s.width/2)/i.width-t.width/2,y:(s.y+s.height/2)/i.height-t.height/2}:n?{x:0,y:0}:e),Ae);J.reaction(((e,t,i)=>{i||this.events.emit(Ke.Move,e)})),this.titleBar=C||new mt({readonly:T.value,title:O.value,namespace:this.namespace,onDragStart:e=>{var t;return null==(t=this._handleTrackStart)?void 0:t.call(this,e)},onEvent:e=>{if(this._delegateEvents.listeners.length>0)this._delegateEvents.emit(e.type);else switch(e.type){case tt.Maximize:F.setValue(!F.value);break;case tt.Minimize:P.setValue(!0);break;case tt.Close:I.setValue(!1);break;default:console.error("Unsupported titleBar event:",e)}}}),T.reaction((e=>{this.titleBar.setReadonly(e)}));const Q=k($),K=k(_),ee=k(z);Ze(this,{prefersColorScheme:S,darkMode:R,containerRect:N,collectorRect:L,title:O,visible:I,readonly:T,resizable:D,draggable:A,fence:H,fixRatio:W,focus:j,zIndex:V,minimized:P,maximized:F,$userContent:Q,$userFooter:K,$userStyles:ee}),this._state$=Y,this._minSize$=X,this._size$=q,this._intrinsicSize$=Z,this._visualSize$=U,this._coord$=J,this._intrinsicCoord$=G,this.fixRatio&&this.transform(J.value.x,J.value.y,q.value.width,q.value.height,!0),this.$box=this.render()}get darkMode(){return this._darkMode$.value}get state(){return this._state$.value}setState(e,t=!1){switch(e){case Je.Maximized:this.setMinimized(!1,t),this.setMaximized(!0,t);break;case Je.Minimized:this.setMinimized(!0,t),this.setMaximized(!1,t);break;default:this.setMinimized(!1,t),this.setMaximized(!1,t)}return this}get minWidth(){return this._minSize$.value.width}get minHeight(){return this._minSize$.value.height}setMinWidth(e,t=!1){return this._minSize$.setValue({width:e,height:this.minHeight},t),this}setMinHeight(e,t=!1){return this._minSize$.setValue({width:this.minWidth,height:e},t),this}get intrinsicWidth(){return this._intrinsicSize$.value.width}get intrinsicHeight(){return this._intrinsicSize$.value.height}resize(e,t,i=!1){return this._intrinsicSize$.setValue({width:e,height:t},i),this}get width(){return this._size$.value.width}get height(){return this._size$.value.height}get absoluteWidth(){return this.width*this.containerRect.width}get absoluteHeight(){return this.height*this.containerRect.height}get visualWidth(){return this._visualSize$.value.width}get visualHeight(){return this._visualSize$.value.height}get intrinsicX(){return this._intrinsicCoord$.value.x}get intrinsicY(){return this._intrinsicCoord$.value.y}move(e,t,i=!1){return this._intrinsicCoord$.setValue({x:e,y:t},i),this}get x(){return this._coord$.value.x}get y(){return this._coord$.value.y}transform(e,t,i,s,r=!1){if(this.fixRatio){const e=this.intrinsicHeight/this.intrinsicWidth*i;t!==this.intrinsicY&&(t-=e-s),s=e}return t<0&&(t=0,s>this.intrinsicHeight&&(s=this.intrinsicHeight)),this._intrinsicCoord$.setValue({x:i>=this.minWidth?e:this.intrinsicX,y:s>=this.minHeight?t:this.intrinsicY},r),this._intrinsicSize$.setValue({width:ot(i,this.minWidth,1),height:ot(s,this.minHeight,1)},r),this}mount(e){return e.appendChild(this.render()),this}unmount(){return this.$box&&this.$box.remove(),this}mountContent(e){return this.set$userContent(e),this}unmountContent(){return this.set$userContent(void 0),this}mountFooter(e){return this.set$userFooter(e),this}unmountFooter(){return this.set$userFooter(void 0),this}getUserStyles(){return this.$userStyles}mountStyles(e){let t;return"string"==typeof e?(t=document.createElement("style"),t.textContent=e):t=e,this.set$userStyles(t),this}unmountStyles(){return this.set$userStyles(void 0),this}render(e){if(e){if(e===this.$box)return this.$box;this.$box=e}else{if(this.$box)return this.$box;this.$box=document.createElement("div")}this._renderSideEffect.flushAll(),this.$box.classList.add(this.wrapClassName("box"));const t=(e,t,i,s=ut)=>this._renderSideEffect.add((()=>{const r=this.wrapClassName(i);return t.subscribe((t=>{e.classList.toggle(r,s(t))}))}));t(this.$box,this._readonly$,"readonly"),t(this.$box,this._draggable$,"no-drag",ft),t(this.$box,this._resizable$,"no-resize",ft),t(this.$box,this._focus$,"blur",ft),t(this.$box,this._darkMode$,"color-scheme-dark"),t(this.$box,this._darkMode$,"color-scheme-light",ft),this._renderSideEffect.add((()=>{const e=this.wrapClassName("minimized"),t=this.wrapClassName("maximized"),i="box-maximized-timer";return this._state$.subscribe((s=>{this.$box.classList.toggle(e,s===Je.Minimized),s===Je.Maximized?(this._renderSideEffect.flush(i),this.$box.classList.toggle(t,!0)):this._renderSideEffect.setTimeout((()=>{this.$box.classList.toggle(t,!1)}),0,i)}))})),this._renderSideEffect.add((()=>this._visible$.subscribe((e=>{this.$box.style.display=e?"block":"none"})))),this._renderSideEffect.add((()=>this._zIndex$.subscribe((e=>{this.$box.style.zIndex=String(e)}))));const i=De(this.$box);this.$box.dataset.teleBoxID=this.id,this.$box.style.width=this.absoluteWidth+"px",this.$box.style.height=this.absoluteHeight+"px";const s=this.x*this.containerRect.width+this.containerRect.x,r=this.y*this.containerRect.height+this.containerRect.y;this.$box.style.transform=`translate(${s-10}px,${r-10}px)`,this._valSideEffectBinder.combine([this._coord$,this._size$,this._minimized$,this._containerRect$,this._collectorRect$],(([e,t,i,s,r])=>{const n=t.width*s.width,o=t.height*s.height;return{width:n,height:o,x:e.x*s.width,y:e.y*s.height,scaleX:i&&r?r.width/n:1,scaleY:i&&r?r.height/o:1}}),Ae).subscribe((e=>{i.set(e)})),i.set({x:s,y:r});const n=document.createElement("div");n.className=this.wrapClassName("box-main"),this.$box.appendChild(n);const o=document.createElement("div");o.className=this.wrapClassName("titlebar-wrap"),o.appendChild(this.titleBar.render()),this.$titleBar=o;const a=document.createElement("div");a.className=this.wrapClassName("content-wrap");const l=document.createElement("div");l.className=this.wrapClassName("content")+" tele-fancy-scrollbar",this.$content=l,this._renderSideEffect.add((()=>{let e;return this._$userStyles$.subscribe((t=>{e&&e.remove(),e=t,t&&l.appendChild(t)}))})),this._renderSideEffect.add((()=>{let e;return this._$userContent$.subscribe((t=>{e&&e.remove(),e=t,t&&l.appendChild(t)}))})),a.appendChild(l);const h=document.createElement("div");return h.className=this.wrapClassName("footer-wrap"),this.$footer=h,this._renderSideEffect.add((()=>{let e;return this._$userFooter$.subscribe((t=>{e&&e.remove(),e=t,t&&h.appendChild(t)}))})),n.appendChild(o),n.appendChild(a),n.appendChild(h),this._renderResizeHandlers(),this.$box}_renderResizeHandlers(){const e=document.createElement("div");e.className=this.wrapClassName("resize-handles"),Object.values(st).forEach((t=>{const i=document.createElement("div");i.className=this.wrapClassName(t)+" "+this.wrapClassName("resize-handle"),i.dataset.teleBoxHandle=t,e.appendChild(i)})),this.$box.appendChild(e);const t="handle-tracking-listener",i=this.wrapClassName("transforming");let s,r,n=0,o=0,a=0,l=0,h=0,c=0;const d=e=>{if(this.state!==Je.Normal)return;at(e);let{pageX:t,pageY:i}=lt(e);i<0&&(i=0);const s=(t-h)/this.containerRect.width,d=(i-c)/this.containerRect.height;switch(r){case st.North:this.transform(this.x,o+d,this.width,l-d);break;case st.South:this.transform(this.x,this.y,this.width,l+d);break;case st.West:this.transform(n+s,this.y,a-s,this.height);break;case st.East:this.transform(this.x,this.y,a+s,this.height);break;case st.NorthWest:this.transform(n+s,o+d,a-s,l-d);break;case st.NorthEast:this.transform(this.x,o+d,a+s,l-d);break;case st.SouthEast:this.transform(this.x,this.y,a+s,l+d);break;case st.SouthWest:this.transform(n+s,this.y,a-s,l+d);break;default:if(this.fence)this.move(ot(n+s,0,1-this.width),ot(o+d,0,1-this.height));else{const e=20/this.containerRect.width,t=20/this.containerRect.height;this.move(ot(n+s,e-this.width,1-e),ot(o+d,0,1-t))}}},u=e=>{r=void 0,s&&(at(e),this.$box.classList.toggle(i,!1),this._sideEffect.flush(t),s.remove())},f=e=>{var f;if(this.readonly)return;if(null!=e.button&&0!==e.button)return;if(!this.draggable||r||this.state!==Je.Normal)return;const m=e.target;if(null==(f=m.dataset)?void 0:f.teleBoxHandle){at(e),n=this.x,o=this.y,a=this.width,l=this.height,({pageX:h,pageY:c}=lt(e)),r=m.dataset.teleBoxHandle,s||(s=document.createElement("div"));const f=r?this.wrapClassName(`cursor-${r}`):"";s.className=this.wrapClassName("track-mask"+(f?` ${f}`:"")),this.$box.appendChild(s),this.$box.classList.add(i),this._sideEffect.add((()=>(window.addEventListener("mousemove",d),window.addEventListener("touchmove",d,{passive:!1}),window.addEventListener("mouseup",u),window.addEventListener("touchend",u,{passive:!1}),window.addEventListener("touchcancel",u,{passive:!1}),()=>{window.removeEventListener("mousemove",d),window.removeEventListener("touchmove",d),window.removeEventListener("mouseup",u),window.removeEventListener("touchend",u),window.removeEventListener("touchcancel",u)})),t)}};this._handleTrackStart=f,this._sideEffect.addEventListener(e,"mousedown",f,{},"box-resizeHandles-mousedown"),this._sideEffect.addEventListener(e,"touchstart",f,{passive:!1},"box-resizeHandles-touchstart")}destroy(){this.$box.remove(),this.events.emit(Ke.Destroyed),this._sideEffect.flushAll(),this._renderSideEffect.flushAll(),this.events.removeAllListeners(),this._delegateEvents.removeAllListeners()}wrapClassName(e){return`${this.namespace}-${e}`}}function pt(){}const bt=(e,t)=>{const i=l(!0);h((()=>{if(!i.current)return e();i.current=!1}),t)},gt=e=>{const[t]=c((()=>new vt(e)));return bt((()=>{null!=e.prefersColorScheme&&t.setPrefersColorScheme(e.prefersColorScheme)}),[t,e.prefersColorScheme]),bt((()=>{null!=e.minWidth&&t.setMinWidth(e.minWidth)}),[t,e.minWidth]),bt((()=>{null!=e.minHeight&&t.setMinHeight(e.minHeight)}),[t,e.minHeight]),bt((()=>{var i,s;t.resize(null!=(i=e.width)?i:t.width,null!=(s=e.height)?s:t.height,!0)}),[t,e.width,e.height]),bt((()=>{var i,s;t.move(null!=(i=e.x)?i:t.x,null!=(s=e.y)?s:t.y,!0)}),[t,e.x,e.y]),bt((()=>{null!=e.title&&t.setTitle(e.title)}),[t,e.title]),bt((()=>{null!=e.visible&&t.setVisible(e.visible)}),[t,e.visible]),bt((()=>{null!=e.minimized&&t.setMinimized(e.minimized,!0)}),[t,e.minimized]),bt((()=>{null!=e.maximized&&t.setMaximized(e.maximized,!0)}),[t,e.maximized]),bt((()=>{null!=e.state&&t.setState(e.state,!0)}),[t,e.state]),bt((()=>{null!=e.draggable&&t.setDraggable(e.draggable)}),[t,e.draggable]),bt((()=>{null!=e.resizable&&t.setResizable(e.resizable)}),[t,e.resizable]),bt((()=>{null!=e.fence&&t.setFence(e.fence)}),[t,e.fence]),bt((()=>{null!=e.containerRect&&t.setContainerRect(e.containerRect)}),[t,e.containerRect]),bt((()=>{null!=e.fixRatio&&t.setFixRatio(e.fixRatio)}),[t,e.fixRatio]),h((()=>{if(e.onResize)return t.events.on(Ke.Resize,e.onResize),()=>{t.events.off(Ke.Resize,e.onResize)}}),[t,e.onResize]),h((()=>{if(e.onMove)return t.events.on(Ke.Move,e.onMove),()=>{t.events.off(Ke.Move,e.onMove)}}),[t,e.onMove]),h((()=>{if(e.onClose)return t.events.on(Ke.Close,e.onClose),()=>{t.events.off(Ke.Close,e.onClose)}}),[t,e.onClose]),h((()=>{if(e.onFocus)return t.events.on(Ke.Focus,e.onFocus),()=>{t.events.off(Ke.Focus,e.onFocus)}}),[t,e.onFocus]),h((()=>{if(e.onBlur)return t.events.on(Ke.Blur,e.onBlur),()=>{t.events.off(Ke.Blur,e.onBlur)}}),[t,e.onBlur]),h((()=>{if(e.onStateChanged)return t.events.on(Ke.State,e.onStateChanged),()=>{t.events.off(Ke.State,e.onStateChanged)}}),[t,e.onStateChanged]),a.createElement("div",{ref:e=>e&&t.render(e),className:t.wrapClassName("box")})};var xt,yt;class wt{constructor({visible:e=!0,readonly:t=!1,darkMode:i=!1,namespace:s="telebox",styles:r={},onClick:n}={}){this.handleCollectorClick=()=>{!this._readonly&&this.onClick&&this.onClick()},this._visible=e,this._readonly=t,this._darkMode=i,this.namespace=s,this.styles=r,this.onClick=n}get visible(){return this._visible}get readonly(){return this._readonly}get darkMode(){return this._darkMode}mount(e){return e.appendChild(this.render()),this}unmount(){return this.$collector&&this.$collector.remove(),this}setVisible(e){return this._visible!==e&&(this._visible=e,this.$collector&&this.$collector.classList.toggle(this.wrapClassName("collector-visible"),e)),this}setReadonly(e){return this._readonly!==e&&(this._readonly=e,this.$collector&&this.$collector.classList.toggle(this.wrapClassName("collector-readonly"),e)),this}setDarkMode(e){return this._darkMode!==e&&(this._darkMode=e,this.$collector&&(this.$collector.classList.toggle(this.wrapClassName("color-scheme-dark"),e),this.$collector.classList.toggle(this.wrapClassName("color-scheme-light"),!e))),this}setStyles(e){if(Object.assign(this.styles,e),this.$collector){const t=this.$collector;Object.keys(e).forEach((i=>{const s=e[i];null!=s&&(t.style[i]=s)}))}return this}render(){return this.$collector||(this.$collector=document.createElement("button"),this.$collector.className=this.wrapClassName("collector"),this.$collector.style.backgroundImage="url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOCAxNiI+CiAgICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIHN0cm9rZT0iIzdCODhBMCIgc3Ryb2tlLXdpZHRoPSIxLjQiIGQ9Ik0uNyAxLjJoMTYuNnYxMy42SC43eiIgLz4KICAgICAgICA8cGF0aCBmaWxsPSIjN0I4OEEwIiBkPSJNNCA1LjVoNnYxLjRINHpNNCA5LjVoMTB2MS40SDR6IiAvPgogICAgPC9nPgo8L3N2Zz4K')",this.$collector.addEventListener("click",this.handleCollectorClick),this._visible&&this.$collector.classList.add(this.wrapClassName("collector-visible")),this._readonly&&this.$collector.classList.add(this.wrapClassName("collector-readonly")),this.$collector.classList.add(this.wrapClassName(this._darkMode?"color-scheme-dark":"color-scheme-light")),this.setStyles(this.styles)),this.$collector}destroy(){this.$collector&&(this.$collector.removeEventListener("click",this.handleCollectorClick),this.$collector.remove(),this.$collector=void 0),this.onClick=void 0}wrapClassName(e){return`${this.namespace}-${e}`}}(yt=xt||(xt={})).Focused="focused",yt.Created="created",yt.Removed="removed",yt.State="state",yt.Maximized="maximized",yt.Minimized="minimized",yt.Move="move",yt.Resize="resize",yt.IntrinsicMove="intrinsic_move",yt.IntrinsicResize="intrinsic_resize",yt.VisualResize="visual_resize",yt.PrefersColorScheme="prefers_color_scheme",yt.DarkMode="dark_mode";class Ct extends mt{constructor(e){super(e),this.boxes=e.boxes,this.focusedBox=e.focusedBox,this.containerRect=e.containerRect,this.darkMode=e.darkMode}focusBox(e){var t;if(e||(e=this.boxes[this.boxes.length-1]),!this.focusedBox||this.focusedBox!==e){if(this.$titles&&this.state===Je.Maximized){const{children:i}=this.$titles.firstElementChild;for(let s=i.length-1;s>=0;s-=1){const r=i[s],n=null==(t=r.dataset)?void 0:t.teleBoxID;n&&(e&&n===e.id?r.classList.toggle(this.wrapClassName("titles-tab-focus"),!0):this.focusedBox&&n===this.focusedBox.id&&r.classList.toggle(this.wrapClassName("titles-tab-focus"),!1))}}this.focusedBox=e}}setContainerRect(e){if(this.containerRect=e,this.$titleBar){const{x:t,y:i,width:s}=e;this.$titleBar.style.transform=`translate(${t}px, ${i}px)`,this.$titleBar.style.width=s+"px"}}setBoxes(e){this.boxes=e,this.updateTitles()}setState(e){super.setState(e),this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("max-titlebar-maximized"),e===Je.Maximized),this.updateTitles()}setReadonly(e){super.setReadonly(e),this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("readonly"),this.readonly)}setDarkMode(e){e!==this.darkMode&&(this.darkMode=e,this.$titleBar&&(this.$titleBar.classList.toggle(this.wrapClassName("color-scheme-dark"),e),this.$titleBar.classList.toggle(this.wrapClassName("color-scheme-light"),!e)))}render(){const e=super.render(),{x:t,y:i,width:s}=this.containerRect;return e.style.transform=`translate(${t}px, ${i}px)`,e.style.width=s+"px",e.classList.add(this.wrapClassName("max-titlebar")),e.classList.toggle(this.wrapClassName("max-titlebar-maximized"),this.state===Je.Maximized),e.classList.toggle(this.wrapClassName("readonly"),this.readonly),e.classList.add(this.wrapClassName(this.darkMode?"color-scheme-dark":"color-scheme-light")),this.updateTitles(),e}destroy(){super.destroy(),this.$titles=void 0,this.boxes.length=0,this.focusedBox=void 0}updateTitles(){this.$titleBar&&this.state===Je.Maximized&&(1===this.boxes.length?this.$title&&(this.$title.textContent=this.boxes[0].title,this.$titleBar.replaceChild(this.$title,this.$titleBar.firstElementChild)):this.$titleBar.replaceChild(this.renderTitles(),this.$titleBar.firstElementChild))}renderTitles(){this.$titles=document.createElement("div"),this.$titles.className=this.wrapClassName("titles"),this.$titles.addEventListener("wheel",(e=>{e.currentTarget.scrollBy({left:e.deltaY>0?250:-250,behavior:"smooth"})}),{passive:!1});const e=document.createElement("div");return e.className=this.wrapClassName("titles-content"),this.$titles.appendChild(e),this.boxes.forEach((t=>{const i=document.createElement("button");i.className=this.wrapClassName("titles-tab"),i.textContent=t.title,i.dataset.teleBoxID=t.id,i.dataset.teleTitleBarNoDblClick="true",this.focusedBox&&t.id===this.focusedBox.id&&i.classList.add(this.wrapClassName("titles-tab-focus")),e.appendChild(i)})),this.$titles}}class $t{constructor({root:e=document.body,prefersColorScheme:t=Ue.Light,minimized:i=!1,maximized:s=!1,fence:r=!0,containerRect:n={x:0,y:0,width:window.innerWidth,height:window.innerHeight},collector:o,namespace:a="telebox",zIndex:l=100,readonly:h=!1}={}){this.events=new u,this.boxes=[],this._sideEffect=new Pe;const{combine:c,createVal:d}=qe(this._sideEffect);this.root=e,this.namespace=a,this.zIndex=l;const f=window.matchMedia("(prefers-color-scheme: dark)"),m=d(!1);f&&(m.setValue(f.matches),this._sideEffect.add((()=>{const e=e=>{m.setValue(e.matches)};return f.addListener(e),()=>f.removeListener(e)})));const v=d(t);v.reaction(((e,t,i)=>{this.boxes.forEach((t=>t.setPrefersColorScheme(e,i))),i||this.events.emit(xt.PrefersColorScheme,e)})),this._darkMode$=c([m,v],(([e,t])=>"auto"===t?e:"dark"===t)),this._darkMode$.reaction(((e,t,i)=>{this.boxes.forEach((t=>t.setDarkMode(e,i))),i||this.events.emit(xt.DarkMode,e)}));const p=d(h);p.reaction(((e,t,i)=>{this.boxes.forEach((t=>t.setReadonly(e,i)))}));const b=d(i),g=d(s);g.reaction(((e,t,i)=>{this.boxes.forEach((t=>t.setMaximized(e,i))),i||this.events.emit(xt.Maximized,e)}));const x=c([b,g],(([e,t])=>e?Je.Minimized:t?Je.Maximized:Je.Normal));x.reaction(((e,t,i)=>{this.maxTitleBar.setState(e),i||this.events.emit(xt.State,e)}));const y=d(r);y.subscribe(((e,t,i)=>{this.boxes.forEach((t=>t.setFence(e,i)))}));const w=d(n,Ae);w.reaction(((e,t,i)=>{this.boxes.forEach((t=>t.setContainerRect(e,i))),this.maxTitleBar.setContainerRect(e)}));const C=d(null===o?null:o||new wt({visible:i,readonly:h,namespace:a}).mount(e));C.subscribe((e=>{e&&(e.setVisible(b.value),e.setReadonly(p.value),e.setDarkMode(this._darkMode$.value),this._sideEffect.add((()=>(e.onClick=()=>{p.value||b.setValue(!1)},()=>e.destroy())),"collect-onClick"))})),p.subscribe((e=>{var t;return null==(t=C.value)?void 0:t.setReadonly(e)})),this._darkMode$.subscribe((e=>{var t;null==(t=C.value)||t.setDarkMode(e)})),b.subscribe(((e,t,i)=>{var s,r;if(null==(s=C.value)||s.setVisible(e),e&&(null==(r=C.value)?void 0:r.$collector)){const{x:e,y:t,width:i,height:s}=C.value.$collector.getBoundingClientRect(),r=this.root.getBoundingClientRect();this.boxes.forEach((n=>{n.setCollectorRect({x:e-r.x,y:t-r.y,width:i,height:s},!0)}))}this.boxes.forEach((t=>t.setMinimized(e,i))),i||this.events.emit(xt.Minimized,e)}));const $=e=>{var t;if(p.value)return;const i=e.target;if(i.tagName)for(let s=i;s;s=s.parentElement){const e=null==(t=s.dataset)?void 0:t.teleBoxID;if(e){const t=this.boxes.find((t=>t.id===e));if(t)return void this.focusBox({focus:!0,box:t})}}};this._sideEffect.addEventListener(window,"mousedown",$,!0),this._sideEffect.addEventListener(window,"touchstart",$,!0),this.maxTitleBar=new Ct({darkMode:this.darkMode,readonly:p.value,namespace:this.namespace,state:x.value,boxes:this.boxes,focusedBox:this._focusedBox,containerRect:w.value,onEvent:e=>{var t;switch(e.type){case tt.Maximize:g.setValue(!g.value);break;case tt.Minimize:b.setValue(!0);break;case Ke.Close:{const e=null!=(t=this._focusedBox)?t:this.boxes[this.boxes.length-1];e&&this.remove(e.id);break}}}}),p.subscribe((e=>this.maxTitleBar.setReadonly(e))),this._darkMode$.subscribe((e=>{this.maxTitleBar.setDarkMode(e)}));Ze(this,{prefersColorScheme:v,containerRect:w,collector:C,readonly:p,fence:y,minimized:b,maximized:g}),this._state$=x,this.root.appendChild(this.maxTitleBar.render())}get darkMode(){return this._darkMode$.value}get state(){return this._state$.value}setState(e,t=!1){switch(e){case Je.Maximized:this.setMinimized(!1,t),this.setMaximized(!0,t);break;case Je.Minimized:this.setMinimized(!0,t),this.setMaximized(!1,t);break;default:this.setMinimized(!1,t),this.setMaximized(!1,t)}return this}create(e){const t=new vt(this.wrapCreateConfig(e));return t.mount(this.root),this.boxes.push(t),t.focus&&this.focusBox({focus:!0,box:t,increaseZIndex:!1}),this.maxTitleBar.setBoxes(this.boxes),t._delegateEvents.on(tt.Maximize,(()=>{this.setMaximized(!this.maximized)})),t._delegateEvents.on(tt.Minimize,(()=>{this.setMinimized(!0)})),t._delegateEvents.on(tt.Close,(()=>{this.focusBox({focus:!1,box:t}),this.remove(t.id)})),t.events.on(Ke.Move,(()=>{this.events.emit(xt.Move,t)})),t.events.on(Ke.Resize,(()=>{this.events.emit(xt.Resize,t)})),t.events.on(Ke.IntrinsicMove,(()=>{this.events.emit(xt.IntrinsicMove,t)})),t.events.on(Ke.IntrinsicResize,(()=>{this.events.emit(xt.IntrinsicResize,t)})),t.events.on(Ke.VisualResize,(()=>{this.events.emit(xt.VisualResize,t)})),this.events.emit(xt.Created,t),t}query(e){return e?this.boxes.filter(this.teleBoxMatcher(e)):[...this.boxes]}queryOne(e){return e?this.boxes.find(this.teleBoxMatcher(e)):this.boxes[0]}update(e,t,i=!1){const s=this.boxes.find((t=>t.id===e));if(s)return this.updateBox(s,t,i)}updateAll(e,t=!1){this.boxes.forEach((i=>{this.updateBox(i,e,t)}))}remove(e,t=!1){const i=this.boxes.findIndex((t=>t.id===e));if(i>=0){const e=this.boxes.splice(i,1);this.maxTitleBar.setBoxes(this.boxes);const s=e[0];return this.focusBox({focus:!1,box:s}),s.destroy(),t||(this.boxes.length<=0&&(this.setMaximized(!1),this.setMinimized(!1)),this.events.emit(xt.Removed,e)),s}}removeAll(e=!1){if(this._focusedBox){const t=this._focusedBox;this._focusedBox=void 0,e||this.events.emit(xt.Focused,void 0,t)}const t=this.boxes.splice(0,this.boxes.length);return this.maxTitleBar.setBoxes(this.boxes),t.forEach((e=>e.destroy())),e||(this.boxes.length<=0&&(this.setMaximized(!1),this.setMinimized(!1)),this.events.emit(xt.Removed,t)),t}destroy(e=!1){this.events.removeAllListeners(),this._sideEffect.flushAll(),this._focusedBox=void 0,this.removeAll(e),Object.keys(this).forEach((e=>{const t=this[e];t instanceof Xe&&t.destroy()}))}wrapClassName(e){return`${this.namespace}-${e}`}teleBoxMatcher(e){const t=Object.keys(e);return i=>t.every((t=>e[t]===i[t]))}updateBox(e,t,i=!1){null==t.x&&null==t.y||e.move(null==t.x?e.intrinsicX:t.x,null==t.y?e.intrinsicY:t.y,i),null==t.width&&null==t.height||e.resize(null==t.width?e.intrinsicWidth:t.width,null==t.height?e.intrinsicHeight:t.height,i),null!=t.title&&(e.setTitle(t.title),this.maxTitleBar.updateTitles()),null!=t.visible&&e.setVisible(t.visible,i),null!=t.minHeight&&e.setMinHeight(t.minHeight,i),null!=t.minWidth&&e.setMinWidth(t.minWidth,i),null!=t.resizable&&e.setResizable(t.resizable),null!=t.draggable&&e.setDraggable(t.draggable),null!=t.fixRatio&&e.setFixRatio(t.fixRatio,i),null!=t.focus&&this.focusBox({focus:t.focus,box:e,skipUpdate:i}),null!=t.content&&e.mountContent(t.content),null!=t.footer&&e.mountFooter(t.footer)}focusBox({focus:e,box:t,skipUpdate:i=!1,increaseZIndex:s=!0}){if(t.setFocus(e,i),t.focus){if(this._focusedBox!==t){const e=this._focusedBox;this._focusedBox&&this._focusedBox.setFocus(!1,i),this._focusedBox=t,s&&t.setZIndex(++this.zIndex),i||this.events.emit(xt.Focused,t,e)}}else this._focusedBox===t&&(this._focusedBox=void 0,i||this.events.emit(xt.Focused,void 0,t));this.maxTitleBar.focusBox(this._focusedBox)}getInitialPosition(e,t){const i=this.boxes.length>0&&this.boxes.reduce(((e,t)=>e.zIndex>t.zIndex?e:t));let s=20,r=20;return i&&(s=i.intrinsicX*this.containerRect.width+20,r=i.intrinsicY*this.containerRect.height+20,(s>this.containerRect.width-e*this.containerRect.width||r>this.containerRect.height-t*this.containerRect.height)&&(s=20,r=20)),{x:s/this.containerRect.width,y:r/this.containerRect.height}}wrapCreateConfig(e={}){let{x:a,y:l}=e;const{width:h=.5,height:c=.5}=e;if(null==a||null==l){const e=this.getInitialPosition(h,c);null==a&&(a=e.x),null==l&&(l=e.y)}return d=((e,t)=>{for(var i in t||(t={}))r.call(t,i)&&o(e,i,t[i]);if(s)for(var i of s(t))n.call(t,i)&&o(e,i,t[i]);return e})({},e),u={x:a,y:l,width:h,height:c,darkMode:this.darkMode,prefersColorScheme:this.prefersColorScheme,maximized:this.maximized,minimized:this.minimized,fence:this.fence,zIndex:this.zIndex,namespace:this.namespace,containerRect:this.containerRect,readonly:this.readonly},t(d,i(u));var d,u}}export{mt as DefaultTitleBar,Ue as TELE_BOX_COLOR_SCHEME,tt as TELE_BOX_DELEGATE_EVENT,Ke as TELE_BOX_EVENT,xt as TELE_BOX_MANAGER_EVENT,st as TELE_BOX_RESIZE_HANDLE,Je as TELE_BOX_STATE,vt as TeleBox,wt as TeleBoxCollector,nt as TeleBoxDragHandleType,$t as TeleBoxManager,gt as TeleBoxReact};
//# sourceMappingURL=telebox-insider.es.js.map
